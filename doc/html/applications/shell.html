The MMT shell is invoked by <a href="../run.html">running</a> <span class="code">mmt</span>.

<h2>Shell Commands</h2>

The language of shell commands is implemented by the <a href="../../api/index.html#info.kwarc.mmt.api.frontend.Action">info.kwarc.mmt.api.frontend.Action</a> class.<br/>

Each subclass comes with scaladoc and can be best understood by browsing the known subclasses in the API documentation.<br/>

The up-to-date context-free grammar for shell commands is part of the constructor parser in the companion object <a href="/api/info/kwarc/mmt/api/frontend/Action$.html">Action</a> and can be best understood by reading the source code.<br/>

<h2>ANSI Formatting in the MMT Shell</h2>

Some shell output uses <a href="http://en.wikipedia.org/wiki/ANSI_escape_code">ANSI escapes</a> for highlighting.

To display the formating, you can use <a href="https://github.com/adoxa/ansicon">ansicon</a> for the windows console or <a href="http://mihai-nita.net/2013/06/03/eclipse-plugin-ansi-in-console/">ansi console</a> for the eclipse console. (Both are optional and very easy to install and use.)
Unix shells should understand it natively.

<h2>MMT Scripts</h2>

An MMT script is a text file containing one shell command per line. (Empty lines are allowed, lines starting with <span class="code">//</span> are ignored.)<br/>

The customary file ending for MMT scripts is <span class="code">.msl</span>.<br/>

These scripts can be run with the <span class="code">file</span> command below.

<h2>Individual Shell Commands</h2>

The following documents some important individual commands.<br/>
This documentation uses upper case names for argument types.<br/>
Some common argument types are:
<ul>
<li>FILE: a file name (relative to the current directory)</li>
<li>FOLDER: a folder name (relative to the current directory)</li>
<li>U: an <a href="../uri.html">MMT URI</a> (relative to the current base URI)</li>
<li>STRING: a string</li>
</ul>

<h3>Basic Commands</h3>

<div class="code">exit</div>
exits MMT (releases all resources and terminates all spawned threads).

<div class="code">extension STRING</div>
registers the <a href="../extensions.html">extension</a> whose qualified Java class name is STRING.
The class must be on the class Java path already.

<div class="code">base URI</div>
sets the base URI to U.

<div class="code">scala [COMMAND]</div>
drops to the scala shell.
Within the scala shell, some special features are available:
<ul>
<li>The variable <span class="code">controller</span> is bound to the MMT <a href="controller.html">controller</a>, which gives users full access to the internal MMT state.</li>
<li>MMT <a href="../../api/index.html#info.kwarc.mmt.api.frontend.MMTInterpolator$MMTContext">interpolations</a> are active: for example, the string mmt"TERM" parses TERM as an MMT term and returns the resulting object.</li>
</ul>
If COMMAND is provided, it is executed immediately (as a Scala REPL command).

<h3>Logging</h3>

See <a href="log.html">log</a> for the logging model.

<div class="code">log console</div>
adds standard output as a logging receiver.

<div class="code">log file FILE</div>
adds the file FILE as a logging receiver.

<div class="code">log filets FILE</div>
as above but adds timestamps to all log messages.

<div class="code">log+ STRING</div>
switches logging on for the component with id STRING.

<div class="code">log- STRING</div>
switches logging off for the component with id STRING.

<h3>Defining make-style targets</h3>

<div class="code">file FILE [STRING]</div>
runs the shell file FILE (which in particular registers all macro definitions in FILE); if provided, immediately runs one of those macros.

<div class="code">define STRING</div>
begins the definition of a named macro.

<div class="code">end</div>
ends the current macro definition.

<div class="code">do STRING [FOLDER]</div>
runs the previously registered macro (FOLDER can be used to disambiguate between multiple macros of the same name defined in different folders)

<h3>Working with MMT content</h3>

MMT reads content automatically by searching for the needed <a href="../uri.html">MMT URI</a> on the math path.<br/>
Therefore, there are only a few commands for directly accessing content.

<div class="code">read FILE</div>
reads a file into memory. Usually this is not necessary because resources are read automatically on demand.

<div class="code">get U [CONTENT] [PRESENT] OUTPUT</div>
retrieves the resource with MMT URI U and applies various operations to it.
This command is largely superseded by the <a href="http.html">HTTP interface</a> but occasionally useful to run on the shell.
<ul>
   <li><span class="code">CONTENT</span> can be
      <ul>
         <li>omitted: simply retrieves U</li>
         <li><span class="code">closure</span>: computes the dependency closure of U and retrieves all elements in it</li>
         <li><span class="code">elaborate</span>: retrieves U and elaborates it</li>
         <li><span class="code">component STRING</span>: retrieves the component STRING of U</li>
      </ul>
   </li>
   <li><span class="code">PRESENT</span> can be
      <ul>
         <li>omitted: presentation as text</li>
         <li><span class="code">present STYLE</span>: presentation using the style STYLE</li>
      </ul>
   </li>
   <li><span class="code">OUTPUT</span> can be
      <ul>
         <li><span class="code">print</span>: print to standard output</li>
         <li><span class="code">write FILE</span>: write to file FILE</li>
         <li><span class="code">window STRING</span>: output to a separate window with id STRING<br/>
         if the id has not been used before, a new window is created; size and position of the created windows can be controlled by other shell commands</li>
         <li><span class="code">respond</span>: no output (useful for programmers who wish to access the result programmatically)</li>
      </ul>
   </li>
</ul>

<div class="code">navigate U</div>
does nothing itself but sends the navigation event to all registered change listener <a href="extensions.html">extensions</a>, which include the <a href="gui.html">GUI</a> (if started).

<div class="code">clear</div>
removes all content from memory.

<h3>The Math Path</h3>

The math path maintains a catalog that maps <a href="../uri.html">MMT URI</a>s to physical locations.<br/>

Several commands exist to add entries to the math path.

<div id="mathpathArchive" class="code">mathpath archive FILE</div>
adds the location of an MMT <a href="../archives.html">archive</a>.<br/>
The path is searched recursively and registers all found archive folders and mar files.

<div class="code">mathpath local</div>
adds the local file system, i.e., file:// URIs are mapped to themselves.

<div class="code">mathpath fs FILE U</div>
adds a catalog entry that maps every URI of the form U/REST to the physical location FILE/REST on the local file system. 

<div class="code">mathpath svn U</div>
adds a catalog entry for a remore SVN repository at URI U.
Every URI U/REST is mapped to itself.

<h3>Archives and Building</h3>

<div class="code">archive ID relational</div>
loads the relational knowledge into memory. 

<div class="code">build ID TARGET</div>
runs a build target.
See the documentation of the <a href="build.html">build tool</a> for details on running build commands on archives.

<h3>Remote Archives</h3>

<div class="code">oaf root FOLDER URI</div>
sets a local folder as the root for git-clones of archives in the <a href="../oaf.html">OAF</a>.

<div class="code">oaf clone GROUP/REPOS</div>
git-clones the archive URI/GROUP/REPOS into FOLDER/GROUP/REPOS and recursively clones its dependencies.

<div class="code">oaf pull</div>
git-pulls (git pull origin master) all repositories in FOLDER.

<div class="code">oaf pushes</div>
git-pushes all repositories in FOLDER.

<h3>Applications</h3>

Note that GUI and HTTP server run in separate threads.
MMT will not terminate if these threads are still active.

<div class="code">server on PORT</div>
starts the <a href="http.html">HTTP server</a> at the port PORT. 

<div class="code">server off</div>
stops the <a href="http.html">HTTP server</a>. 

<div class="code">gui on</div>
starts the <a href="gui.html">MMT GUI</a>. 

<div class="code">gui off</div>
stops the <a href="gui.html">MMT GUI</a>.