<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:jobad="http://omdoc.org/presentation">
<head>
  <meta charset="UTF-8" />
  <!-- <link rel="stylesheet" type="text/css" href="/css/omdoc/omdoc-default.css"/> --> 

  <link rel="stylesheet" type="text/css" href="/css/mmt.css"/>
  <link rel="stylesheet" type="text/css" href="/css/browser.css"/>
  <!-- Presenter-specific CSS for MMT (if needed) - this is for HTMLPresenter -->
  <link rel="stylesheet" type="text/css" href="/css/mmt-html.css"/> 
  <link rel="stylesheet" type="text/css" href="/css/JOBAD.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery/jquery-ui.css"/>
  <!-- <link rel="stylesheet" type="text/css" href="/css/jquery/ui.base.css"/> -->
  <link rel="shortcut icon" href="/favicon.ico" />
  <script type="text/javascript" src="/script/jquery/jquery.js"></script>
  <!-- <script type="text/javascript" src="/script/jquery/jquery.xmlns.js"/> -->

  <script src="script/codemirror2/lib/codemirror.js"></script>
  <link rel="stylesheet" href="script/codemirror2/lib/codemirror.css"/>
  <script src="script/codemirror2/mode/lf/lf.js"></script>

  <script type="text/javascript" src="/script/jquery/jquery-ui.js"></script>
  <script type="text/javascript" src="/script/tree/jquery.hotkeys.js"></script>
  <script type="text/javascript" src="/script/tree/jquery.jstree.js"></script>
  <!-- JOBAD Deps -->
  <script type="text/javascript" src="/script/jobad/deps/underscore-min.js"></script>
  <!-- JOBAD -->
  <script type="text/javascript" src="/script/jobad/JOBAD.js"></script>
  <!-- MMT API -->
    <!-- Core JS API for MMT interaction -->
  <script type="text/javascript" src="/script/mmt/mmt-js-api.js"></script>
    <!-- Presenter-specific JS functionality for MMT (if needed) - this if for HTMLPresenter -->
  <script type="text/javascript" src="/script/mmt/mmt-html.js"></script> 
  <!-- JOBAD Services -->
  <script type="text/javascript" src="/script/jobad/modules/navigation.js"></script>
  <script type="text/javascript" src="/script/jobad/modules/hovering.js"></script>
  <script type="text/javascript" src="/script/jobad/modules/interactive-viewing.js"></script>
   
    <!-- JOBAD Init -->
  <script type="text/javascript">
	var JOBAD1;
	$(function(){	
	JOBAD1 = new JOBAD($("#main,#inputviewterm,#inputviewtype"));
	JOBAD1.modules.load("kwarc.mmt.navigation", []);
	JOBAD1.modules.load("kwarc.mmt.hovering", []);
	JOBAD1.modules.load("kwarc.mmt.intvw", []);
	JOBAD1.Setup();
	})		
  </script>
  
  <script type="text/javascript">
    $(function () {
       $("#pathtree").jstree({
           "core" : {"animation": 0},
           "xml_data" : {
              "ajax" : {
                 "url" : "/:tree",
                 "data" : function(node) {return (node == -1) ? ":root" : node.attr("id");}
              },
              "xsl" : "nest"
           },
           "themes" : {"theme" : "classic", "icons" : false},
           "plugins" : ["xml_data", "themes", "ui", "hotkeys"]
       });
   });
    
   var graphWindow = null;
   function openGraph(p) {
      if (p == null)
         p = "";
      else
         p = "?" + p;
      graphWindow = window.open('graph.html' + p);
   };
   
   $(function(){
      var inpbox = $('#inputbox');
      var ana = $('#inputanalyze')[0];
      var simp = $('#inputsimplify')[0];
      function simpPres(e) {
         var eS = simp.checked ? qmt.simplify(e) : e;
         return qmt.present(eS);
      }
      $('#inputbox,#inputanalyze,#inputsimplify').on('change keyup paste', function(){
         var q = qmt.parse(qmt.literalString(inpbox.val()));
         if (ana.checked) {
            var qA = qmt.analyze(q);
            q = qmt.let(qA, qmt.tuple(simpPres(qmt.bound(1)) + simpPres(qmt.bound(2))));
         } else {
            q = simpPres(q);
         }
		   qmt.exec(q,
		      function(resultNode){
		         var result = $(resultNode.firstChild).children();
		         var inpviewterm = $('#inputviewterm')[0];
		         var inpviewtype = $('#inputviewtype')[0];
		         var tm = result[0].firstChild
		         var tp = ana.checked ? result[1].firstChild : window.document.createElement('div');
		         inpviewterm.replaceChild(tm, inpviewterm.firstChild);
		         inpviewtype.replaceChild(tp, inpviewtype.firstChild);
		      }
		   );
		})
   });
   
   $(function(){$('#latin-dialog').dialog({ autoOpen: false})});
  </script>
  
  <script type="text/javascript">
     function toggleClick(elem){
        $(elem).parent().closest('div').find('.toggleTarget').toggle()
     }
  </script>
  
  <script type="text/javascript">
      function search(){
         var base   = $('#base').val();
         var module = $('#module').val();
         var name   = $('#name').val();
         var theory = $('#theory').val();
         var pattern= $('#pattern').val();
         var type   = $('#type').is(':checked');
         var definition= $('#definition').is(':checked');
		   $.ajax({'url': '/:search',
				     'dataType': 'xml',
				     'data': {base: base, module: module, name: name,
				               theory: theory, pattern: pattern, type: type, definition: definition},
				     'success': function(data){
				        $('#results').children().replaceWith(data.firstChild);
				     }
			       });
      }
      function resultClick(p){
         navigation.navigate(p);
      }
   </script>
</head>

<body><table>
     
  <tr><td colspan="2" class="layout">
    <div id="top">
      <div id="title">The MMT Web Server</div>
      <div id="menu_bar">
        <!--<span class="pagelink"><a href="/search.html">Search</a></span>-->
        <span class="pagelink"><a href="javascript:openGraph()">Graph View</a></span>
        <span class="pagelink"><a href="/admin.html" target="_blank">Administration</a></span>
        <span class="pagelink"><a href="/help.html" target="_blank">Help</a></span>
      </div>
    </div>
  </td></tr>
   
  <tr>
      <td class="layout">
         <div id="styleselector">
            Style: <span id="currentstyle"/><br/>
            <!--<input type="text" size="20" id="inputstyle"></input><button onclick="javascript:setStyle($('#inputstyle').val())">set</button> -->
         </div>
    
   
       <div id="sidebar">
          <div id="pathtree"></div>
       </div>
     </td>
    
     <td class="layout">
       <div id="breadcrumbs">
         <div></div>
       </div>

       <div id="main">
         <div></div>
       </div>
    </td>
  </tr>
</table>  

<div id="parse">
<button onclick="toggleClick(this)">show/hide</button>
<b>Parse-analyze-simplify-present</b>
<table class="toggleTarget">
  <tr>
    <td class="layout">
      <div>
        <span>Enter an object over theory: </span>
        <input type="text" style="resize:horizontal;" size="30" class="activetheory" id="activetheory"></input>
      </div>
    </td>
    <td>
        <span><input type="checkbox" id="inputanalyze"/>analyze</span>
        <span><input type="checkbox" id="inputsimplify"/>simplify</span>
    </td>
  </tr>
  <tr>
    <td>
      <textarea id="inputbox"></textarea>
    </td>
    <td>
      result: <span id="inputviewterm"><div></div></div><br/>
      inferred type:<span id="inputviewtype"><div></div></div>
    </td>
  </tr>
</table>
</div>

<div id="search">
<button onclick="toggleClick(this)">show/hide</button>
<b>Search</b>
<table class="toggleTarget">
  <tr><td colspan="2" class="layout">
     <div class="searchgroup">Enter <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#sum">Java regular expressions</a> to filter based on the URI of a declaration<br/>
     <table>
        <tr><td class="uriregexp">Namespace</td><td><input type="text" size="30" id="base"></input></div></td></tr>
     
     <tr><td class="uriregexp">Theory</td><td><input type="text" size="30" id="module"></input></div></td></tr>
     <tr><td class="uriregexp">Name</td><td><input type="text" size="30" id="name"></input></div></td></tr>
     </table>
     </div>
     <!--<div>Roles:
        <span><input type="checkbox" id="constant"/>primitive</span>
        <span><input type="checkbox" id="defined"/>defined</span>
        <span><input type="checkbox" id="axiom"/>axiom</span>
        <span><input type="checkbox" id="theorem"/>theorem</span>
     </div>-->
     <div class="searchgroup">
       Enter an expression over theory <input type="text" size="50" id="theory" class="activetheory"></input> to match inside the <input type="checkbox" id="type" checked="checked"/> type or <input type="checkbox" id="definition"/> definiens of a declaration<br/>
       <input type="text" size="50" id="pattern"></input><br/>
        Use $x,y,z:query to enter unification variables.
     </div>
     <div><input type="button" value="Search" id="search" onclick="search()"/></div>
     <div id="results"><div/></div>
  </td></tr>
</div>

<div id="latin-dialog"><span/></div>
</body>

</html>
