(window.webpackJsonp=window.webpackJsonp||[]).push([[3],[,function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(6)),n=o(16),d=i(o(17)),a=i(o(18)),r=i(o(19)),l=i(o(20)),h=o(11),g=i(o(23)),c=i(o(24)),u=i(o(25)),m=i(o(26)),p=i(o(28));t.default=class{constructor(e){this.recievedDataJSON="",this.lastGraphDataUsed="",this.lastGraphTypeUsed="",this.config=new n.Configuration(e),this.dom=new g.default(this.config),this.resizer=new a.default(this.dom),this.statusLogger=new d.default(this.dom,"statusBar"),this.actionHistory=new r.default,this.theoryGraph=new l.default(this.config,this.dom,"mynetwork",this.statusLogger,this.actionHistory),this.actionHistory.init(this.theoryGraph),this.legendPanel=new c.default(this.dom,"mynetworkLegend",this.config,this.statusLogger),this.tgDomListener=new u.default(this.theoryGraph,this.config,this.dom,this),this.ui=new m.default(this.dom,this.theoryGraph,this.tgDomListener,this.statusLogger,this.config,this.actionHistory,this),this.treeMenu=new p.default(this.config,this.dom,this),this.init()}init(){this.dom.$(".custom-menu-side li").click(e=>{var t=s.default(e.target).attr("data-action");"close"!=t&&this.createNewGraph(t,this.lastGraphDataUsed),this.dom.$(".custom-menu-side").hide(10)});var e=this.config.preferences.source;this.theoryGraph.onConstructionDone=this.updateNetworkOnFirstCall.bind(this),"html"==e?this.theoryGraph.loadGraphByLocalStorage(h.getParameterByName(n.Configuration.graphDataURLDataSourceParameterNameTGView)||void 0):"param"==e?this.theoryGraph.loadGraphByURIParameter(h.getParameterByName(n.Configuration.graphDataURLDataSourceParameterNameTGView)||void 0):"json"==e?this.theoryGraph.loadJSONGraph(this.config.preferences.json||void 0):"iframe"==e?this.waitForJSONMessage.bind(this)():this.createNewGraph(this.config.preferences.type,this.config.preferences.graphdata)}destroy(){this.dom.$(".custom-menu-side li").off("click"),this.treeMenu.destroy(),this.ui.destroy(),this.tgDomListener.destroy(),this.legendPanel.destroy(),this.theoryGraph.destroy(),this.actionHistory.destroy(),this.statusLogger.destroy(),this.resizer.destroy(),this.dom.destroy()}createNewGraph(e,t){var o=e||this.lastGraphTypeUsed,i=t||this.lastGraphDataUsed;if(this.lastGraphTypeUsed=o,this.lastGraphDataUsed=i,this.config.preferences.isMathhub){var s=this.config.graphDataURL+n.Configuration.graphDataURLTypeParameterName+"="+o+"&"+n.Configuration.graphDataURLDataParameterName+"="+i;this.theoryGraph.getGraph(s);var d=location.protocol+"//"+location.host+location.pathname+"?"+n.Configuration.graphDataURLTypeParameterNameTGView+"="+o+"&"+n.Configuration.graphDataURLDataParameterNameTGView+"="+i;void 0!==this.config.preferences.highlight&&(d+="&"+n.Configuration.graphDataURLHighlightParameterNameTGView+"="+this.config.preferences.highlight),h.setLocation(d)}else this.theoryGraph.getGraph(i)}waitForJSONMessage(){""==this.recievedDataJSON?setTimeout(this.waitForJSONMessage.bind(this),500):(this.theoryGraph.loadJSONGraph(JSON.parse(this.recievedDataJSON)),this.recievedDataJSON="")}updateNetworkOnFirstCall(){this.theoryGraph.colorizeNodesByName(this.config.preferences.highlight,this.config.highlightColorByURI),this.ui.generateEdgesNodesHideDiv(),this.theoryGraph.hideEdges("graphmeta",!0);var e=this.theoryGraph.getUsedNodeTypes(),t=this.theoryGraph.getUsedEdgeTypes();this.legendPanel.load(e,t)}}},,,,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLocation=function(e){try{history.pushState(null,document.title,e)}catch(t){location.hash="#"+e}},t.rainbow=function(e,t){let o=0,i=0,s=0;const n=t/e,d=~~(6*n),a=6*n-d,r=1-a;switch(d%6){case 0:o=1,i=a,s=0;break;case 1:o=r,i=1,s=0;break;case 2:o=0,i=1,s=a;break;case 3:o=0,i=r,s=1;break;case 4:o=a,i=0,s=1;break;case 5:o=1,i=0,s=r}return"#"+("00"+(~~(255*o)).toString(16)).slice(-2)+("00"+(~~(255*i)).toString(16)).slice(-2)+("00"+(~~(255*s)).toString(16)).slice(-2)},t.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},t.getStartToEnd=function(e,t){return t>0?{start:e,end:e+t}:{start:e+t,end:e}}},,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanNode=function(e,t){const o=Object.assign({style:"no-style-provided",shape:"square",label:"",previewhtml:"",mathml:"",url:"",childsURL:"",membership:0,options:{hidden:!1},graphNumber:-1,hidden:!1,toConnected:[],fromConnected:[],connectedNodes:[],connectedNodesById:{},modularityPart:0,idx:-1,overallLength:0,overallVisited:0,overallWeight:0,visited:!1,forcesFixed:!1,dispX:0,dispY:0,x:0,y:0},e,{id:(void 0!==e.id?e.id:"no-id-provided").toString()}),i=t[o.style];if(void 0!==o.style&&i){const e=o.previewhtml&&o.previewhtml.length>10||o.mathml&&o.mathml.length>10;"ellipse"===i.shape||"circle"===i.shape?o.shape=e?"circularImage":"ellipse":"square"===i.shape?o.shape=e?"image":"square":o.shape=e?"image":i.shape,void 0!==o.color&&"string"!=typeof o.color||(o.color={highlight:{}}),i.color&&(o.color.background=i.color),i.colorBorder&&(o.color.border=i.colorBorder),i.colorHighlightBorder&&(o.color.border=i.colorBorder),i.colorHighlight&&(o.color.highlight=i.colorHighlight),void 0===o.shapeProperties&&(o.shapeProperties={}),i.dashes&&(o.shapeProperties.borderDashes=[5,5])}return o},t.cleanEdge=function(e,t){const o=Object.assign({from:"none",to:"none",style:"no-style-provided",clickText:"",weight:"",url:""},e,{id:(null!=e.id?e.id:"no-id-provided").toString()}),i=t[o.style||""];return o.style&&i&&(o.arrows={to:{enabled:i.directed,type:i.circle?"circle":"arrow"}},i.smoothEdge&&(o.smooth=!1),o.dashes=i.dashes,o.width=i.width,o.color={color:i.color,highlight:i.colorHighlight,hover:i.colorHover}),o},t.ensureUniqueIds=function(e){const t=new Set;return e.map((e,o)=>(void 0!==e.id&&(t.has(e.id)&&(e.id+="_"+o),t.add(e.id)),e))}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,o,i){this.logger=o,this.countNodesInGraph=[],this.myAllNodes=e,this.edgesCount=t.length,this.mapEdgesIntoNodes(t,i),this.identifySubgraphs()}destroy(){this.myAllNodes=[],this.countNodesInGraph=[]}mapEdgesIntoNodes(e,t){this.logger.setStatusText("Mapping Edges to Nodes...");for(var o={},i=0;i<this.myAllNodes.length;i++)this.myAllNodes[i].toConnected=[],this.myAllNodes[i].fromConnected=[],this.myAllNodes[i].connectedNodes=[],this.myAllNodes[i].connectedNodesById={},o[this.myAllNodes[i].id]=this.myAllNodes[i],this.myAllNodes[i].modularityPart=0,this.myAllNodes[i].idx=i;for(i=0;i<e.length;i++)null==e[i].from||null==o[e[i].from]?console.log("Not found: "+e[i].from):null==e[i].to||null==o[e[i].to]?console.log("Not found: "+e[i].to):void 0===t||!0!==t[e[i].style]||!0!==t["graph"+e[i].style]?(o[e[i].from].toConnected.push(o[e[i].to]),o[e[i].to].fromConnected.push(o[e[i].from]),o[e[i].to].connectedNodes.push(o[e[i].from]),o[e[i].from].connectedNodes.push(o[e[i].to]),o[e[i].to].connectedNodesById[e[i].from]=o[e[i].from],o[e[i].from].connectedNodesById[e[i].to]=o[e[i].to]):console.log("Ignore edge: "+e[i].from+" Type: "+e[i].style)}identifySubgraphs(){this.logger.setStatusText("Identify Subgraphs...");for(var e=[],t=1,o=0;o<this.myAllNodes.length;o++){var i=this.myAllNodes[o];if(i.graphNumber<1&&1!=i.hidden){for(e.push(i),this.countNodesInGraph.push(0);e.length>0;){this.countNodesInGraph[this.countNodesInGraph.length-1]++;var s=e.pop();s.graphNumber=t;for(var n=0;n<s.connectedNodes.length;n++){var d=s.connectedNodes[n];d.graphNumber<1&&1!=d.hidden&&e.push(d)}}t++}}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectPng="data:image/png;base64,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",t.deleteRegionPng="data:image/png;base64,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",t.moveRegionPng="data:image/png;base64,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",t.addRegionPng="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA7CAYAAAAq55mNAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gUEDRAXERMMywAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAjklEQVRo3u3bwQ2AIBAEQM/YmY3RmLXhywo44gVm/xoma0i4YBwTEu3uI8/39kT2ms5jk0SlJme2uk2joKCgoKCgoKCgoKCgoKB/JLInA9XyTSr2aXTlNm1GoKCgoKCgoKCgoKAO3g7eJRpNf2nCF5J9WeOqBrQZgYKCgoKCgoKCgoKCgq6UkhMGP/gM5AVG8xv4tHC7nwAAAABJRU5ErkJggg=="},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=o(11);class s{constructor(e){this.colorizingNodesArray=["#CCCCFF","#FFFFCC","#FFCC99","#CCFFCC","#DDDDDD","#FFCCCC"],this.highlightColorByURI="#ff8080",this.LEGEND_PANEL_OPTIONS={physics:{enabled:!1,stabilization:!1},interaction:{dragNodes:!1,dragView:!1,hideEdgesOnDrag:!1,hideNodesOnDrag:!1,hover:!1,hoverConnectedEdges:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0},multiselect:!1,navigationButtons:!1,selectable:!1,selectConnectedEdges:!1,tooltipDelay:300,zoomView:!1},nodes:{physics:!1,shapeProperties:{useImageSize:!0,useBorderWithImage:!0}},edges:{smooth:{enabled:!0,type:"straightCross",roundness:.3}}},this.THEORY_GRAPH_OPTIONS={physics:{enabled:!1,solver:"barnesHut",barnesHut:{avoidOverlap:1},stabilization:{enabled:!0,iterations:5}},interaction:{multiselect:!0},nodes:{physics:!1,shapeProperties:{useImageSize:!0,useBorderWithImage:!0}},edges:{smooth:{enabled:!0,type:"straightCross",roundness:.3}}},this.ARROW_STYLES={include:{color:"#cccccc",colorHighlight:"#cccccc",colorHover:"#cccccc",dashes:!1,circle:!1,directed:!0,smoothEdge:!0,width:1,alias:"Include-Edges"},attack:{color:"#673232",colorHighlight:"#7e1b1b",colorHover:"#673232",dashes:!1,circle:!1,directed:!0,smoothEdge:!0,width:1,alias:"Attack-Edges"},modelinclude:{color:"black",colorHighlight:"black",colorHover:"black",dashes:!1,circle:!1,directed:!1,smoothEdge:!1,width:1,alias:"Model Includes-Edges"},meta:{color:"green",colorHighlight:"green",colorHover:"green",dashes:!0,circle:!0,directed:!0,smoothEdge:!0,width:1,alias:"Meta-Edges"},alignment:{color:"red",colorHighlight:"red",colorHover:"red",dashes:!0,circle:!1,directed:!1,smoothEdge:!0,width:1,alias:"Alignment-Edges"},view:{color:"black",colorHighlight:"black",colorHover:"black",dashes:!1,circle:!1,directed:!0,smoothEdge:!0,width:1,alias:"View-Edges"},structure:{color:"#cccccc",colorHighlight:"#cccccc",colorHover:"#cccccc",dashes:!0,circle:!1,directed:!0,smoothEdge:!0,width:1,alias:"Structure-Edges"}},this.NODE_STYLES={model:{shape:"square",color:"#DDDDDD",colorBorder:"#222222",colorHighlightBorder:"#444444",colorHighlight:"#EEEEEE",dashes:!1,alias:"Model-Nodes"},sceptically_accepted:{shape:"circle",color:"#ff9900",colorBorder:"#ffa31a",colorHighlightBorder:"#ffad33",colorHighlight:"#ffb84d",dashes:!1,alias:"Sceptically Accepted"},credulously_accepted:{shape:"circle",color:"#009900",colorBorder:"#008000",colorHighlightBorder:"#00b300",colorHighlight:"#00cc00",dashes:!1,alias:"Credulously Accepted"},rejected:{shape:"circle",color:"#ff4d4d",colorBorder:"#ff0000",colorHighlightBorder:"#ff6666",colorHighlight:"#ff8080",dashes:!1,alias:"Rejected-Nodes"},border:{shape:"circle",color:"#E8E8E8",colorBorder:"#D8D8D8",colorHighlightBorder:"#A8A8A8",colorHighlight:"#D8D8D8",dashes:!1,alias:"Border-Nodes"},theory:{shape:"circle",color:"#D2E5FF",colorBorder:"#2B7CE9",colorHighlightBorder:"#2B7CE9",colorHighlight:"#D2E5FF",dashes:!1,alias:"Theory-Nodes"},boundarycondition:{shape:"square",color:"#EEEEEE",colorBorder:"#DDDDDD",colorHighlightBorder:"#CCCCCC",colorHighlight:"#DDDDDD",dashes:!0,alias:"Boundary-Condition-Nodes"}},this.GRAPH_TYPES=[{id:"thgraph",menuText:"Th. Graph",tooltip:""},{id:"pgraph",menuText:"P Graph",tooltip:""},{id:"docgraph",menuText:"Doc Graph",tooltip:""},{id:"archivegraph",menuText:"Archive Graph",tooltip:""},{id:"mpd",menuText:"MPD Graph",tooltip:"MPD Graph-Viewer"}];const t=e.mainContainer||"tgViewMainEle",o="string"==typeof t?document.getElementById(t):t instanceof HTMLElement?t:t.get(0);this.preferences={serverBaseURL:e.serverBaseURL||"/",serverUrl:e.serverUrl,menuUrl:e.menuUrl,isMathhub:void 0===e.isMathhub||e.isMathhub,viewOnlyMode:e.viewOnlyMode||!1,source:e.source||i.getParameterByName(s.graphDataURLSourceParameterNameTGView)||void 0,type:e.type||i.getParameterByName(s.graphDataURLTypeParameterNameTGView)||void 0,graphdata:e.graphdata||i.getParameterByName(s.graphDataURLDataParameterNameTGView)||void 0,json:e.json||void 0,highlight:e.highlight||i.getParameterByName(s.graphDataURLHighlightParameterNameTGView)||void 0,mainContainer:o,prefix:e.prefix||"custom-prefix-"},this.serverBaseURL=this.preferences.serverBaseURL||"/",this.serverUrl=this.serverBaseURL||("file:"==window.location.protocol?"/":"/mh/mmt/"),void 0!==this.preferences.serverUrl&&(this.serverUrl=this.preferences.serverUrl),this.preferences.isMathhub||(this.serverUrl="/");const n=void 0===this.preferences.menuUrl?this.serverUrl+":jgraph/menu?id=":this.preferences.menuUrl;this.menuEntriesURL=(e=>"string"==typeof n?n+(e||""):n(e,this.serverUrl)),this.graphDataURL=this.serverUrl+":jgraph/json?"}}s.graphDataURLTypeParameterName="key",s.graphDataURLDataParameterName="uri",s.graphDataURLTypeParameterNameTGView="type",s.graphDataURLDataParameterNameTGView="graphdata",s.graphDataURLHighlightParameterNameTGView="highlight",s.graphDataURLSourceParameterNameTGView="source",s.graphDataURLDataSourceParameterNameTGView="uri",t.Configuration=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.dom=e,this.statusbar=this.dom.getElementById(t)}destroy(){this.setStatusCursor("auto")}setStatusText(e){this.statusbar.innerHTML=e}setStatusCursor(e){this.dom.mainElement.style.cursor=e||"auto"}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(6));t.default=class{constructor(e){this.dom=e,this.widthTreeBefore=350,this.doResize=this.doResize.bind(this),this.resizeMenuDiv=this.resizeMenuDiv.bind(this),this.dom.mainElement$.ready(()=>{this.doResize(),this.interval=window.setInterval(this.resizeMenuDiv,250),s.default(window).resize(this.doResize)})}destroy(){this.interval&&(window.clearInterval(this.interval),this.interval=void 0),s.default(window).off("resize",this.doResize)}resizeMenuDiv(){const e=this.dom.getElementById("theory_tree_div").offsetWidth;this.widthTreeBefore!=e&&(this.widthTreeBefore=e,this.dom.getElementById("mySidenav").style.width=this.widthTreeBefore+16+"px")}doResize(){const e=this.dom.getElementById("toolCanvas");e.style.width=(window.innerWidth-36|0)+"px",e.style.height=(window.innerHeight-74|0)+"px",this.dom.getElementById("mainbox").style.width=(window.innerWidth-36|0)+"px";const t=this.dom.getElementById("wholeNetwork");t.style.width=(window.innerWidth-36|0)+"px",t.style.height=(window.innerHeight-74|0)+"px"}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.theoryGraph=void 0,this.historyStates=[],this.undoneHistoryStates=[],this.lastActionWasUndoRedo=!1}init(e){this.theoryGraph=e}destroy(){this.theoryGraph=void 0,this.historyStates=[],this.undoneHistoryStates=[]}addToStateHistory(e){this.historyStates.push(e),this.lastActionWasUndoRedo||(this.undoneHistoryStates=[]),this.lastActionWasUndoRedo=!1}undoLastAction(){if(0==this.historyStates.length)return;const e=this.historyStates.pop();if(this.undoneHistoryStates.push(e),this.lastActionWasUndoRedo=!0,void 0===e.func)return;let t=!0;if("cluster"==e.func)this.theoryGraph.openCluster(e.param.clusterId),this.historyStates.pop();else if("uncluster"==e.func)this.theoryGraph.cluster(e.param.nodes,e.param.name,e.param.clusterId),this.historyStates.pop();else if("select"==e.func)this.theoryGraph.selectNodes([]),this.historyStates.pop();else if("unselect"==e.func)this.theoryGraph.selectNodes(e.param.nodes),this.historyStates.pop();else if("addNode"==e.func)this.theoryGraph.deleteNodes([e.param.node.id]),this.historyStates.pop(),t=!1;else if("editNode"==e.func)this.theoryGraph.saveNode(e.param.oldNode),this.historyStates.pop();else if("deleteNodes"==e.func){for(var o=0;o<e.param.nodes.length;o++)this.theoryGraph.addNode(e.param.nodes[o]),this.historyStates.pop();for(o=0;o<e.param.edges.length;o++)this.theoryGraph.addEdge(e.param.edges[o]),this.historyStates.pop()}else if("addEdge"==e.func)this.theoryGraph.deleteEdges([e.param.edge.id]),this.historyStates.pop(),t=!1;else if("editEdge"==e.func)this.theoryGraph.saveEdge(e.param.oldEdge),this.historyStates.pop();else if("deleteEdges"==e.func)for(o=0;o<e.param.edges.length;o++)this.theoryGraph.addEdge(e.param.edges[o]),this.historyStates.pop();else if("cageNodes"==e.func)this.theoryGraph.removeNodeRegion(e.param.index);else if("hideNodes"==e.func)this.theoryGraph.hideNodesById(e.param.hideNodes.map(e=>e.id),!e.param.hidden),this.historyStates.pop();else if("hideEdges"==e.func){var i=[];for(o=0;o<e.param.hideEdges.length;o++)i.push(e.param.hideEdges[o].id);this.theoryGraph.hideEdgesById(i,!e.param.hidden),this.historyStates.pop()}else"selectEdges"==e.func&&(this.theoryGraph.selectEdgesById([]),this.historyStates.pop());1==t&&this.doLastAction(),this.lastActionWasUndoRedo=!1}redoLastAction(){if(0!=this.undoneHistoryStates.length){this.lastActionWasUndoRedo=!0;var e=this.undoneHistoryStates.pop();if(void 0!==e.func){if("cluster"==e.func)this.theoryGraph.cluster(e.param.nodes,e.param.name,e.param.clusterId);else if("uncluster"==e.func)this.theoryGraph.openCluster(e.param.clusterId);else if("select"==e.func)this.theoryGraph.selectNodes(e.param.nodes);else if("unselect"==e.func)this.theoryGraph.selectNodes([]);else if("addNode"==e.func)this.theoryGraph.addNode(e.param.node);else if("editNode"==e.func)this.theoryGraph.saveNode(e.param.newNode);else if("deleteNodes"==e.func){for(var t=[],o=0;o<e.param.edges.length;o++)t.push(e.param.edges[o].id);for(this.theoryGraph.deleteEdges(t),t=[],o=0;o<e.param.nodes.length;o++)t.push(e.param.nodes[o].id);this.theoryGraph.deleteNodes(t)}else if("addEdge"==e.func)this.theoryGraph.addEdge(e.param.edge);else if("editEdge"==e.func)this.theoryGraph.saveEdge(e.param.newEdge);else if("deleteEdges"==e.func){for(t=[],o=0;o<e.param.edges.length;o++)t.push(e.param.edges[o].id);this.theoryGraph.deleteEdges(t)}else if("cageNodes"==e.func)this.theoryGraph.cageNodes(e.param.nodeIds,e.param.color);else if("hideNodes"==e.func)this.theoryGraph.hideNodesById(e.param.hideNodes.map(e=>e.id),e.param.hidden);else if("hideEdges"==e.func){var i=[];for(o=0;o<e.param.hideEdges.length;o++)i.push(e.param.hideEdges[o].id);this.theoryGraph.hideEdgesById(i,e.param.hidden)}else"selectEdges"==e.func&&(this.theoryGraph.selectEdgesById(e.param.edges),this.historyStates.pop());this.lastActionWasUndoRedo=!1}}}doLastAction(){if(0!=this.historyStates.length){this.lastActionWasUndoRedo=!0;for(var e=this.historyStates.length-1;e>=0;e--){var t=this.historyStates[e];if("unselect"==t.func){this.theoryGraph.selectNodes([]),this.historyStates.pop();break}if("select"==t.func){this.theoryGraph.selectNodes(t.param.nodes),this.historyStates.pop();break}}this.lastActionWasUndoRedo=!1}}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(11),n=o(12),d=o(13),a=i(o(21)),r=i(o(22)),l=i(o(6)),h=o(15);t.default=class{constructor(e,t,o,i,s){this.config=e,this.dom=t,this.containerName=o,this.statusLogger=i,this.actionLogger=s,this.originalNodes=[],this.originalEdges=[],this.nodes=null,this.edges=null,this.network=null,this.clusterId=0,this.allClusters=[],this.clusterPositions={},this.lastClusterZoomLevel=0,this.zoomClusters=[],this.hiddenNodes={},this.edgesNameToHide=[],this.doCallAfterConstruction=!0,this.manualFocus=!1,this.allNodeRegions=[],this.allManuallyHiddenNodes=[],this.moveRegionHold=!1,this.moveRegionId=0,this.addNodeToRegion=!1,this.removeRegionImg=new Image,this.moveRegionImg=new Image,this.addNodeToRegionImg=new Image,this.removeRegionImg.src=h.deleteRegionPng,this.moveRegionImg.src=h.moveRegionPng,this.addNodeToRegionImg.src=h.addRegionPng}destroy(){this.dom.$(".custom-menu li").off("click"),this.originalNodes=[],this.originalEdges=[],this.edges&&this.edges.clear(),this.edges=null,this.nodes&&this.nodes.clear(),this.nodes=null,this.network&&(this.network.destroy(),this.network=null),this.allClusters=[],this.clusterPositions={},this.zoomClusters=[],this.hiddenNodes={},this.edgesNameToHide=[],this.onConstructionDone=void 0,this.allNodeRegions=[],this.allManuallyHiddenNodes=[],this.internalOptimizer&&this.internalOptimizer.destroy()}focusOnNodes(e){var t=[];if(void 0===e&&(e=this.network.getSelectedNodes().map(e=>e.toString())),null!=e&&0!=e.length){t=t.concat(e);for(var o=[],i=0;i<e.length;i++){var s=this.network.getPositions(e[i]),n=this.network.getConnectedEdges(e[i]);o=o.concat(n.map(e=>e.toString()));var d=this.network.getConnectedNodes(e[i],"to").map(e=>e.toString()),a=this.network.getConnectedNodes(e[i],"from").map(e=>e.toString());if(1==e.length){for(var r=0;r<a.length;r++)s.y-this.network.body.nodes[a[r]].y<200&&(this.network.body.nodes[a[r]].y=s.y-(50*Math.random()+150)),Math.abs(s.x-this.network.body.nodes[a[r]].x)>200&&(this.network.body.nodes[a[r]].x=s.x+400*Math.random()-200);for(r=0;r<d.length;r++)s.y-this.network.body.nodes[d[r]].y>200&&(this.network.body.nodes[d[r]].y=s.y+(50*Math.random()+150)),Math.abs(s.x-this.network.body.nodes[a[r]].x)>200&&(this.network.body.nodes[d[r]].x=s.x+400*Math.random()-200)}t=(t=t.concat(a)).concat(d)}this.hideNodesById(t,!1);var l=[];for(i=0;i<this.originalNodes.length;i++)this.originalNodes[i].y=this.network.body.nodes[this.originalNodes[i].id].y,this.originalNodes[i].x=this.network.body.nodes[this.originalNodes[i].id].x,-1==t.indexOf(this.originalNodes[i].id)&&l.push(this.originalNodes[i].id);if(this.hideNodesById(l,!0),1==e.length){if(!this.internalOptimizer)throw new Error("internalOptimizer not initialized");this.internalOptimizer.SolveUsingForces(25,12,!1)}var h=[];for(i=0;i<this.originalNodes.length;i++)h.push({id:this.originalNodes[i].id,x:this.originalNodes[i].x,y:this.originalNodes[i].y});this.nodes.update(h),this.statusLogger.setStatusText("");var g=[];for(i=0;i<this.originalEdges.length;i++)g.push(this.originalEdges[i].id);this.hideEdgesById(g,!0),this.hideEdgesById(o,!1)}}manipulateSelectedRegion(e){var t=[],o=!1,i=!1;if(1==this.moveRegionHold){if(void 0===this.oldRegionPosition)throw new Error("trying to manuipulate selected region, but oldRegionPosition is undefined");for(var s=e,n=s.x-this.oldRegionPosition.x,d=s.y-this.oldRegionPosition.y,a=(this.network.getPositions(this.allNodeRegions[this.moveRegionId].nodeIds),0);a<this.allNodeRegions[this.moveRegionId].nodeIds.length;a++)void 0!==this.allNodeRegions[this.moveRegionId].nodeIds[a]&&t.push({id:this.allNodeRegions[this.moveRegionId].nodeIds[a],x:this.network.body.nodes[this.allNodeRegions[this.moveRegionId].nodeIds[a]].x+n,y:this.network.body.nodes[this.allNodeRegions[this.moveRegionId].nodeIds[a]].y+d});this.moveRegionHold=!1,this.statusLogger.setStatusCursor("auto"),this.oldRegionPosition=e,i=!0,o=!0,this.nodes.update(t)}else for(a=0;a<this.allNodeRegions.length;a++)if(1==this.allNodeRegions[a].selected){if(this.allNodeRegions[a].left-44<=e.x&&this.allNodeRegions[a].left>=e.x&&this.allNodeRegions[a].top-6<=e.y&&this.allNodeRegions[a].top+34>=e.y){this.removeNodeRegion(a),o=!0;break}if(this.allNodeRegions[a].left-42<=e.x&&this.allNodeRegions[a].left>=e.x&&this.allNodeRegions[a].top+40<=e.y&&this.allNodeRegions[a].top+74>=e.y){this.moveRegionHold=!0,this.moveRegionId=a,this.oldRegionPosition=e,this.statusLogger.setStatusCursor("pointer"),i=!0;break}if(this.allNodeRegions[a].left-74<=e.x&&this.allNodeRegions[a].left>=e.x&&this.allNodeRegions[a].top+86<=e.y&&this.allNodeRegions[a].top+122>=e.y){this.addNodeRegionId=a,this.addNodeToRegion=!0,this.statusLogger.setStatusCursor("copy"),i=!0;break}}return 1==o&&this.network.redraw(),i}selectRegion(e){for(var t=!1,o=0;o<this.allNodeRegions.length;o++)this.allNodeRegions[o].selected=!1,this.allNodeRegions[o].left<=e.x&&this.allNodeRegions[o].right>=e.x&&this.allNodeRegions[o].top<=e.y&&this.allNodeRegions[o].bottom>=e.y&&(this.allNodeRegions[o].selected=!0,t=!0);1==t&&this.network.redraw()}removeNodeRegion(e){this.allNodeRegions.splice(e,1),this.network.redraw()}drawAllColoredRegionsOnCanvas(e){for(var t=0;t<this.allNodeRegions.length;t++){e.fillStyle=this.allNodeRegions[t].color,e.strokeStyle=this.allNodeRegions[t].color,e.setLineDash([8]);var o=e.lineWidth;1==this.allNodeRegions[t].selected?(e.drawImage(this.removeRegionImg,this.allNodeRegions[t].left-46,this.allNodeRegions[t].top-8,38,38),e.drawImage(this.moveRegionImg,this.allNodeRegions[t].left-46,this.allNodeRegions[t].top+38,38,38),e.drawImage(this.addNodeToRegionImg,this.allNodeRegions[t].left-46,this.allNodeRegions[t].top+84,38,38),e.lineWidth=10):e.lineWidth=6,e.strokeRect(this.allNodeRegions[t].left,this.allNodeRegions[t].top,this.allNodeRegions[t].right-this.allNodeRegions[t].left,this.allNodeRegions[t].bottom-this.allNodeRegions[t].top),e.setLineDash([]),e.lineWidth=o}}drawAllColoredRegions(e){if(0!=this.allNodeRegions.length){for(var t=0;t<this.allNodeRegions.length;t++){this.allNodeRegions[t].left=1e7,this.allNodeRegions[t].right=-1e7,this.allNodeRegions[t].top=1e7,this.allNodeRegions[t].bottom=-1e7,this.allNodeRegions[t].mappedNodes={};for(var o=0;o<this.allNodeRegions[t].nodeIds.length;o++)if(1!=this.hiddenNodes[this.allNodeRegions[t].nodeIds[o]]){var i=this.network.getBoundingBox(this.allNodeRegions[t].nodeIds[o]);this.allNodeRegions[t].left=Math.min(this.allNodeRegions[t].left,i.left),this.allNodeRegions[t].right=Math.max(this.allNodeRegions[t].right,i.right),this.allNodeRegions[t].top=Math.min(this.allNodeRegions[t].top,i.top),this.allNodeRegions[t].bottom=Math.max(this.allNodeRegions[t].bottom,i.bottom),this.allNodeRegions[t].mappedNodes[this.allNodeRegions[t].nodeIds[o]]=1}var s=4*t%20+8;1e7!=this.allNodeRegions[t].left&&(this.allNodeRegions[t].left-=s,this.allNodeRegions[t].right+=s,this.allNodeRegions[t].top-=s,this.allNodeRegions[t].bottom+=s,e.fillStyle=this.allNodeRegions[t].color,e.strokeStyle=this.allNodeRegions[t].color,1==this.allNodeRegions[t].selected?e.globalAlpha=.5:e.globalAlpha=.2,e.fillRect(this.allNodeRegions[t].left,this.allNodeRegions[t].top,this.allNodeRegions[t].right-this.allNodeRegions[t].left,this.allNodeRegions[t].bottom-this.allNodeRegions[t].top),e.globalAlpha=1)}this.repositionNodes()}}intersectRect(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom}liesInAnyRegion(e,t){for(var o=0;o<this.allNodeRegions.length;o++)if(void 0===this.allNodeRegions[o].mappedNodes[t]&&1==this.intersectRect(e,this.allNodeRegions[o]))return o;return-1}repositionNodes(){for(var e=[],t=0;t<this.originalNodes.length;t++){for(var o=this.network.getBoundingBox(this.originalNodes[t].id),i=0,s=0,n=0,d=0;d<this.allNodeRegions.length;d++)void 0!==this.allNodeRegions[d].mappedNodes[this.originalNodes[t].id]&&(i+=(this.allNodeRegions[d].left+this.allNodeRegions[d].right)/2,s+=(this.allNodeRegions[d].top+this.allNodeRegions[d].bottom)/2,n++);for(i/=n,s/=n,d=0;d<this.allNodeRegions.length;d++)if(void 0===this.allNodeRegions[d].mappedNodes[this.originalNodes[t].id]&&1==this.intersectRect(o,this.allNodeRegions[d])){var a,r,l=0,h=o.right-o.left,g=o.bottom-o.top;if(0==n?(a=Math.abs(o.right-this.allNodeRegions[d].left),(r=Math.abs(o.left-this.allNodeRegions[d].right))<a&&(l=1,a=r),(r=Math.abs(o.bottom-this.allNodeRegions[d].top))<a&&(l=2,a=r),(r=Math.abs(o.top-this.allNodeRegions[d].bottom))<a&&(l=3,a=r)):(a=Math.abs(this.allNodeRegions[d].left-h/1.8-i)+Math.abs((o.bottom+o.top)/2-s),(r=Math.abs(this.allNodeRegions[d].right+h/1.8-i)+Math.abs((o.bottom+o.top)/2-s))<a&&(l=1,a=r),(r=Math.abs(this.allNodeRegions[d].top-g/1.8-s)+Math.abs((o.left+o.right)/2-i))<a&&(l=2,a=r),(r=Math.abs(this.allNodeRegions[d].bottom+g/1.8-s)+Math.abs((o.left+o.right)/2-i))<a&&(l=3,a=r)),0==l){for(var c=0,u=this.allNodeRegions[d].left-h/1.8;-1!=c;)o.left=u-h/2,o.right=u+h/2,-1!=(c=this.liesInAnyRegion(o,this.originalNodes[t].id))&&(u=this.allNodeRegions[c].left-h/1.8);e.push({x:u,id:this.originalNodes[t].id})}else if(1==l){for(c=0,u=this.allNodeRegions[d].right+h/1.8;-1!=c;)o.left=u-h/2,o.right=u+h/2,-1!=(c=this.liesInAnyRegion(o,this.originalNodes[t].id))&&(u=this.allNodeRegions[c].right+h/1.8);e.push({x:u,id:this.originalNodes[t].id})}else if(2==l){c=0;for(var m=this.allNodeRegions[d].top-g/1.8;-1!=c;)o.top=m-g/2,o.bottom=m+g/2,-1!=(c=this.liesInAnyRegion(o,this.originalNodes[t].id))&&(m=this.allNodeRegions[c].top-g/1.8);e.push({y:m,id:this.originalNodes[t].id})}else if(3==l){for(c=0,m=this.allNodeRegions[d].bottom+g/1.8;-1!=c;)o.top=m-g/2,o.bottom=m+g/2,-1!=(c=this.liesInAnyRegion(o,this.originalNodes[t].id))&&(m=this.allNodeRegions[c].bottom+g/1.8);e.push({y:m,id:this.originalNodes[t].id})}}}for(t=0;t<e.length;t++){var p=e[t];void 0!==p.x&&(this.network.body.nodes[e[t].id].x=p.x),void 0!==p.y&&(this.network.body.nodes[e[t].id].y=p.y)}}selectNodesByType(e){for(var t=this.network.getSelectedNodes().map(e=>e.toString()),o=0;o<this.originalNodes.length;o++){var i=this.originalNodes[o];i.style==e&&t.push(i.id.toString())}this.actionLogger.addToStateHistory({func:"select",param:{nodes:t}}),this.network.selectNodes(t)}selectEdgesById(e){this.actionLogger.addToStateHistory({func:"selectEdges",param:{edges:e}}),this.network.selectEdges(e)}selectEdgesByType(e){for(var t=[],o=0;o<this.originalEdges.length;o++){var i=this.originalEdges[o];i.style==e&&t.push(i.id)}this.actionLogger.addToStateHistory({func:"selectEdges",param:{edges:t}}),this.network.selectEdges(t)}getUsedNodeTypes(){for(var e=[],t=0;t<this.originalNodes.length;t++)void 0!==this.originalNodes[t].style&&-1==e.indexOf(this.originalNodes[t].style)&&e.push(this.originalNodes[t].style);return e}getUsedEdgeTypes(){for(var e=[],t=0;t<this.originalEdges.length;t++)void 0!==this.originalEdges[t].style&&-1==e.indexOf(this.originalEdges[t].style)&&e.push(this.originalEdges[t].style);return e}graphToIFrameString(e,t,o){return void 0===e&&(e="tgviewGraphData_"+Math.floor((new Date).getTime()/1e3)+"_"+Math.floor(1e3*Math.random())),void 0===t&&(t=!1),void 0===o&&(o=0),{storage:"localStorage.setItem('"+e+"', '"+this.generateCompressedJSON(t,o).split("'").join("\\'")+"');",uri:location.protocol+"//"+location.host+location.pathname+"?source=iframe&uri="+e,id:e}}graphToLocalStorageString(e,t,o){return void 0===e&&(e="tgviewGraphData_"+Math.floor((new Date).getTime()/1e3)+"_"+Math.floor(1e3*Math.random())),void 0===t&&(t=!1),void 0===o&&(o=0),{storage:"localStorage.setItem('"+e+"', '"+this.generateCompressedJSON(t,o).split("'").join("\\'")+"');",uri:location.protocol+"//"+location.host+location.pathname+"?source=param&uri="+e,name:e}}graphToURIParameterString(e,t){return void 0===e&&(e=!1),void 0===t&&(t=2),location.protocol+"//"+location.host+location.pathname+"?source=param&uri="+encodeURI(this.generateCompressedJSON(e,t))}graphToStringJSON(e,t){return void 0===e&&(e=!1),void 0===t&&(t=0),this.generateCompressedJSON(e,t)}generateCompressedJSON(e,t){var o={},i='{"nodes":[';void 0===e&&(e=!1),void 0===t&&(t=0),0==t&&(o=this.network.getPositions());var s=void 0,n={};if(1==e){s=this.network.getSelectedNodes();for(var d=0;d<s.length;d++)n[s[d]]=1}var a={},r=0;for(d=0;d<this.originalNodes.length;d++){var l="{",h=this.originalNodes[d];1==e&&void 0===n[h.id]||(void 0===a[h.id]&&(a[h.id]=r,r++),l+='"id":"'+h.id+'",',l+='"label":"'+h.label+'",',l+='"style":"'+h.style+'"',h.shape&&(l+=',"shape":"'+h.shape+'"'),h.mathml&&(l+=',"mathml":"'+h.mathml.split('"').join("'")+'"'),h.previewhtml&&(l+=',"previewhtml":"'+h.previewhtml.split('"').join("'")+'"'),void 0!==h.url&&""!=h.url&&t<2&&(l+=',"url":"'+h.url+'"'),0==t&&(l+=',"x":"'+o[h.id].x+'"',l+=',"y":"'+o[h.id].y+'"'),i+=l+="},")}for(i=i.substring(0,i.length-1)+'],"edges":[',d=0;d<this.originalEdges.length;d++){var g=this.originalEdges[d];if(void 0!==a[g.to]&&void 0!==a[g.from]){var c="{";c+='"to":"'+g.to+'",',c+='"from":"'+g.from+'",',c+='"style":"'+g.style+'"',void 0!==g.label&&""!=g.label&&t<2&&(c+=',"label":"'+g.label+'"'),void 0!==g.weight&&""!=g.weight&&t<2&&(c+=',"weight":"'+g.weight+'"'),void 0!==g.url&&""!=g.url&&t<2&&(c+=',"url":"'+g.url+'"'),i+=c+="},"}}if(this.allClusters.length>0)for(i=i.substring(0,i.length-1)+'],"cluster":[',d=0;d<this.allClusters.length;d++){var u='{"nodeIds":';u+=JSON.stringify(this.clusterPositions[this.allClusters[d]][0]),u+=",",u+='"nodePositions":',u+=JSON.stringify(this.clusterPositions[this.allClusters[d]][1]),u+="",i+=u+="},"}return i=i.substring(0,i.length-1)+"]}"}loadGraphByLocalStorage(e){void 0===e&&(e="tgviewGraphData");var t=localStorage.getItem(e);this.drawGraph(JSON.parse(t))}loadGraphByURIParameter(e){var t=s.getParameterByName("uri");this.drawGraph(JSON.parse(t))}hideEdges(e,t){this.setEdgesHidden(e,t);for(var o=[],i=0;i<this.originalEdges.length;i++)e!=this.originalEdges[i].style&&"graph"+e!=this.originalEdges[i].style||(1==t?o.push({id:this.originalEdges[i].id,hidden:t}):0==t&&0==this.hiddenNodes[this.originalEdges[i].to]&&0==this.hiddenNodes[this.originalEdges[i].from]&&o.push({id:this.originalEdges[i].id,hidden:t}));this.edges.update(o)}hideEdgesById(e,t){if(void 0!==e&&0!=e.length){for(var o=[],i=0;i<e.length;i++)o.push({id:e[i],hidden:t});this.edges.update(o),this.actionLogger.addToStateHistory({func:"hideEdges",param:{hideEdges:o,hidden:t}})}}showAllManuallyHiddenNodes(){for(var e=[],t=[],o=0;o<this.allManuallyHiddenNodes.length;o++){for(var i=0;i<this.allManuallyHiddenNodes[o].nodes.length;i++)this.allManuallyHiddenNodes[o].nodes[i].hidden=!1,e.push(this.allManuallyHiddenNodes[o].nodes[i]),this.hiddenNodes[this.allManuallyHiddenNodes[o].nodes[i].id]=!1;for(this.nodes.update(this.allManuallyHiddenNodes[o].nodes),i=0;i<this.allManuallyHiddenNodes[o].edges.length;i++)this.allManuallyHiddenNodes[o].edges[i].hidden=!1,t.push(this.allManuallyHiddenNodes[o].edges[i]);this.edges.update(this.allManuallyHiddenNodes[o].edges)}this.allManuallyHiddenNodes=[],this.actionLogger.addToStateHistory({func:"hideNodes",param:{hideNodes:e,hideEdges:t,hidden:!1}})}hideNodesById(e,t){void 0!==e&&0!=e.length||(e=this.network.getSelectedNodes().map(e=>e.toString()));for(var o=[],i=0;i<e.length;i++)o.push({id:e[i],hidden:t}),this.hiddenNodes[e[i]]=t;this.nodes.update(o);var s=[];for(i=0;i<this.originalEdges.length;i++)1!=t||1!=this.hiddenNodes[this.originalEdges[i].to]&&1!=this.hiddenNodes[this.originalEdges[i].from]||s.push({id:this.originalEdges[i].id,hidden:t}),0==t&&0==this.hiddenNodes[this.originalEdges[i].to]&&0==this.hiddenNodes[this.originalEdges[i].from]&&s.push({id:this.originalEdges[i].id,hidden:t});this.edges.update(s),this.allManuallyHiddenNodes.push({nodes:o,edges:s}),this.actionLogger.addToStateHistory({func:"hideNodes",param:{hideNodes:o,hideEdges:s,hidden:t}})}hideNodes(e,t){for(var o=[],i=0;i<this.originalNodes.length;i++)e!=this.originalNodes[i].style&&"graph"+e!=this.originalNodes[i].style||(o.push({id:this.originalNodes[i].id,hidden:t}),this.hiddenNodes[this.originalNodes[i].id]=t);this.nodes.update(o);var s={};for(i=0;i<this.edgesNameToHide.length;i++)s[this.edgesNameToHide[i].type]=this.edgesNameToHide[i].hidden;var n=[];for(i=0;i<this.originalEdges.length;i++)1!=t||1!=this.hiddenNodes[this.originalEdges[i].to]&&1!=this.hiddenNodes[this.originalEdges[i].from]||n.push({id:this.originalEdges[i].id,hidden:t}),void 0!==s[this.originalEdges[i].style]&&s[this.originalEdges[i].style]!=t||0==t&&0==this.hiddenNodes[this.originalEdges[i].to]&&0==this.hiddenNodes[this.originalEdges[i].from]&&n.push({id:this.originalEdges[i].id,hidden:t});this.edges.update(n)}setEdgesHidden(e,t){for(var o=0;o<this.edgesNameToHide.length;o++)if(e==this.edgesNameToHide[o].type)return void(this.edgesNameToHide[o].hidden=t);this.edgesNameToHide.push({hidden:t,type:e})}downloadCanvasAsImage(e){for(var t=111110,o=111110,i=-111110,s=-111110,n=0;n<this.originalNodes.length;n++){var d=this.originalNodes[n],a=this.network.getPositions([d.id]);t=Math.min(a[d.id].x,t),i=Math.max(a[d.id].x,i),o=Math.min(a[d.id].y,o),s=Math.max(a[d.id].y,s)}var r=this.network.canvas.frame.canvas.width+"px",l=this.network.canvas.frame.canvas.height+"px",h=Math.min(1.2*(i-t),3500)+"px",g=Math.min(1.2*(s-o),3500)+"px";this.network.setSize(h,g),this.network.redraw(),this.network.fit(),this.network.once("afterDrawing",()=>{var e=document.createElement("a");e.target="_blank",e.download="graph.png";var t=this.network.canvas.frame.canvas.toDataURL("image/png"),o=window.URL,i=t;e.href=i,document.body.appendChild(e),e.click(),document.body.removeChild(e),o.revokeObjectURL(i),this.network.setSize(r,l),this.network.redraw(),this.network.fit(),this.statusLogger.setStatusText("")})}selectNodes(e){this.network.selectNodes(e),this.actionLogger.addToStateHistory({func:"select",param:{nodes:e}})}selectNodesWithIdLike(e){for(var t=[],o=0;o<this.originalNodes.length;o++){var i=this.originalNodes[o];i.id.indexOf(e)>-1&&t.push(i.id)}this.actionLogger.addToStateHistory({func:"select",param:{nodes:t}}),this.network.selectNodes(t)}cageNodes(e,t){void 0===e&&(e=this.network.getSelectedNodes().map(e=>e.toString())),null==t&&(t="#"+(4*Math.floor(4*Math.random())).toString(16)+(4*Math.floor(4*Math.random())).toString(16)+(4*Math.floor(4*Math.random())).toString(16));for(var o=0;o<this.allNodeRegions.length;o++)this.allNodeRegions[o].selected=!1;this.allNodeRegions.push({nodeIds:e,color:t,selected:!0,mappedNodes:{},top:NaN,bottom:NaN,left:NaN,right:NaN}),this.actionLogger.addToStateHistory({func:"cageNodes",param:{nodeIds:e,color:t,index:this.allNodeRegions.length-1}}),this.network.redraw()}selectNodesInRect(e){for(var t=[],o=s.getStartToEnd(e.startX,e.w),i=s.getStartToEnd(e.startY,e.h),n=0;n<this.originalNodes.length;n++){var d=this.originalNodes[n],a=this.network.getPositions([d.id]);if(void 0!==a&&void 0!==this.network.body.nodes[d.id]&&1!=this.network.body.nodes[d.id].options.hidden){var r=this.network.canvasToDOM({x:a[d.id].x,y:a[d.id].y});o.start<=r.x&&r.x<=o.end&&i.start<=r.y&&r.y<=i.end&&t.push(d.id)}}this.actionLogger.addToStateHistory({func:"select",param:{nodes:t}}),this.network.selectNodes(t)}colorizeNodesByName(e,t){if(void 0!==e&&null!=e&&null!=e){var o=[],i=[];i="string"==typeof e?e.replace(" ","").split(","):e;for(var s=0;s<i.length;s++){console.log("^"+i[s].replace("*","(.*)")+"$");for(var n=new RegExp("^"+i[s].split("*").join("(.*)")+"$"),d=0;d<this.originalNodes.length;d++)n.test(this.originalNodes[d].label)&&o.push(this.originalNodes[d].id)}this.colorizeNodes(o,t)}}clusterUsingColor(){const e=new a.default(this.originalNodes,this.originalEdges,this.statusLogger);var t=10,o=10,i=200,n=1e3;this.originalNodes.length>800?(t=3,o=3,i=50,n=2e3):this.originalNodes.length>500?(t=5,o=3,i=100,n=2e3):this.originalNodes.length>200?(t=5,o=5,i=150,n=1e3):this.originalNodes.length>100&&(t=5,o=10,i=200,n=1e3);const d=e.cluster(t,o,i,n);e.destroy();for(var r=[],l=[],h=0;h<d.length;h++)void 0===r[d[h]]&&(r[d[h]]=[],l.push(d[h])),r[d[h]].push(this.originalNodes[h].id);for(h=0;h<d.length;h++)this.originalNodes[h].membership=d[h];for(this.startRendering(),h=0;h<l.length;h++)this.colorizeNodes(r[l[h]],s.rainbow(l.length,h),!1);this.network.redraw()}colorizeNodes(e,t,o=!0){if(void 0===e&&(e=this.network.getSelectedNodes().map(e=>e.toString())),null==t&&(t="blue"),null!=this.network){for(var i=[],s=0;s<e.length;s++)i.push({id:e[s],color:{background:t,highlight:{background:t}}});this.nodes.update(i),1==o&&this.network.redraw()}}cluster(e,t,o){if(void 0===o&&(o=this.clusterId.toString()),null==e&&(e=this.network.getSelectedNodes().map(e=>e.toString())),null==t&&(t="cluster_"+o),null!=this.network){this.clusterPositions["cluster_"+o]=[e,this.network.getPositions(e)],this.allClusters.push("cluster_"+o);var i={joinCondition:t=>-1!=e.indexOf(t.id),processProperties:function(e,t,o){for(var i=0,s=0;s<t.length;s++)i+=t[s].mass;return e.mass=i,e},clusterNodeProperties:{id:"cluster_"+o,borderWidth:2,shape:"database",color:"orange",label:t}};this.network.clustering.cluster(i),this.actionLogger.addToStateHistory({func:"cluster",param:{clusterId:"cluster_"+o,name:t,nodes:e}}),this.clusterId++}}getGraph(e){this.statusLogger.setStatusText("Downloading graph..."),this.statusLogger.setStatusCursor("wait"),l.default.ajaxSetup({error:(e,t)=>{0==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading graph failed (Check Your Network)</font>'),this.statusLogger.setStatusCursor("auto")):404==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading graph failed (Requested URL not found)</font>'),this.statusLogger.setStatusCursor("auto")):500==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading graph failed (Internel Server Error)</font>'),this.statusLogger.setStatusCursor("auto")):(this.statusLogger.setStatusText('<font color="red">Downloading graph failed (HTTP-Error-Code: '+e.status+")</font>"),this.statusLogger.setStatusCursor("auto"),console.log(e))}}),l.default.get(e,this.drawGraph.bind(this))}loadJSONGraph(e){return"string"==typeof e&&e.length<20||void 0===e?(this.statusLogger.setStatusText('<font color="red">Graph-File is empty or corrupt</font>'),void this.statusLogger.setStatusCursor("auto")):("string"==typeof e&&(e=JSON.parse(e)),void 0===e.nodes||void 0===e.edges?(this.statusLogger.setStatusText('<font color="red">Graph-File is invalid (maybe incorrect JSON?)</font>'),void this.statusLogger.setStatusCursor("auto")):void this.loadDataSet(e.nodes,e.edges,!0))}drawGraph(e,t=200){return 200!=t&&"success"!=t?(this.statusLogger.setStatusText('<font color="red">Downloading graph failed (HTTP-Error-Code: '+t+")</font>"),void this.statusLogger.setStatusCursor("auto")):"string"==typeof e?(this.statusLogger.setStatusText('<font color="red">Graph-File is empty or corrupt</font>'),void this.statusLogger.setStatusCursor("auto")):void 0===e.nodes||void 0===e.edges?(this.statusLogger.setStatusText('<font color="red">Graph-File is invalid (maybe incorrect JSON?)</font>'),void this.statusLogger.setStatusCursor("auto")):void this.loadDataSet(e.nodes,e.edges)}loadDataSet(e,t,o){this.originalNodes=e.map(e=>d.cleanNode(e,this.config.NODE_STYLES)),this.originalEdges=t.map(e=>d.cleanEdge(e,this.config.ARROW_STYLES)),this.addUsedButNotDefinedNodes(),this.originalNodes=d.ensureUniqueIds(this.originalNodes),this.originalEdges=d.ensureUniqueIds(this.originalEdges),this.startConstruction(o)}addUsedButNotDefinedNodes(){this.statusLogger.setStatusText("Adding used but not defined nodes...");for(var e={},t=0;t<this.originalNodes.length;t++)e[this.originalNodes[t].id]=this.originalNodes[t];for(t=0;t<this.originalEdges.length;t++){if(null!=this.originalEdges[t].from&&null==e[this.originalEdges[t].from]){null!=(s=(i=this.originalEdges[t].from).split("?"))[1]&&(i=s[1]);var o={id:this.originalEdges[t].from,style:"border",label:i,url:this.originalEdges[t].from};this.originalNodes.push(d.cleanNode(o,this.config.NODE_STYLES)),e[this.originalEdges[t].from]=o,console.log("Border-Node: "+i+" ("+this.originalEdges[t].from+")")}var i,s;if(null!=this.originalEdges[t].to&&null==e[this.originalEdges[t].to])null!=(s=(i=this.originalEdges[t].to).split("?"))[1]&&(i=s[1]),o={id:this.originalEdges[t].to,style:"border",label:i,url:this.originalEdges[t].to},this.originalNodes.push(d.cleanNode(o,this.config.NODE_STYLES)),e[this.originalEdges[t].to]=o,console.log("Border-Node: "+i+" ("+this.originalEdges[t].to+")")}}addNodesAndEdges(e,t=200){if(200!=t&&"success"!=t)return this.statusLogger.setStatusText('<font color="red">Downloading nodes failed (HTTP-Error-Code: '+t+")</font>"),void this.statusLogger.setStatusCursor("auto");if("string"==typeof e)return this.statusLogger.setStatusText('<font color="red">Graph-File is empty or corrupt</font>'),void this.statusLogger.setStatusCursor("auto");if(void 0===e.nodes||void 0===e.edges)return this.statusLogger.setStatusText('<font color="red">Graph-File is invalid (maybe incorrect JSON?)</font>'),void this.statusLogger.setStatusCursor("auto");var o=e.nodes.map(e=>d.cleanNode(e,this.config.NODE_STYLES)),i=e.edges.map(e=>d.cleanEdge(e,this.config.ARROW_STYLES));o=d.ensureUniqueIds(o),i=d.ensureUniqueIds(i),this.edges.update(i),this.nodes.update(o),this.originalEdges=this.originalEdges.concat(i),this.originalNodes=this.originalNodes.concat(o),this.statusLogger.setStatusText('<font color="green">Successfully recieved '+o.length+" node(s) and "+i.length+" edge(s)!</font>"),this.statusLogger.setStatusCursor("auto")}addNode(e){let t=d.cleanNode(e,this.config.NODE_STYLES);this.originalNodes.push(t),""!=t.mathml&&(t=this.nodeToSVGMath(t)),""!=t.previewhtml&&(t=this.nodeToSVGHTML(t)),this.nodes.update(t),this.actionLogger.addToStateHistory({func:"addNode",param:{node:t}})}addEdge(e){const t=d.cleanEdge(e,this.config.ARROW_STYLES);this.originalEdges.push(t),this.edges.update(t),this.actionLogger.addToStateHistory({func:"addEdge",param:{edge:t}})}deleteEdges(e){var t=[];this.originalEdges=this.originalEdges.filter(o=>{for(var i=!0,s=0;s<e.length;s++)if(o.id==e[s]){i=!1,t.push(o);break}return i}),this.edges.remove(e),this.actionLogger.addToStateHistory({func:"deleteEdges",param:{edges:t}})}deleteNodes(e,t){var o=[],i=[];this.originalNodes=this.originalNodes.filter(t=>{for(var i=!0,s=0;s<e.length;s++)if(t.id==e[s]){i=!1,o.push(t);break}return i}),this.nodes.remove(e),void 0!==t&&(this.originalEdges=this.originalEdges.filter(e=>{for(var o=!0,s=0;s<t.length;s++)if(e.id==t[s]){o=!1,i.push(e);break}return o}),this.edges.remove(t)),this.actionLogger.addToStateHistory({func:"deleteNodes",param:{nodes:o,edges:i}})}saveEdge(e){let t=void 0,o=d.cleanEdge(e,this.config.ARROW_STYLES);for(var i=0;i<this.originalEdges.length;i++)if(this.originalEdges[i].id==o.id){t=this.originalEdges[i],this.originalEdges[i]=o;break}this.edges.update(o),this.actionLogger.addToStateHistory({func:"editEdge",param:{newEdge:o,oldEdge:t}})}saveNode(e){let t=void 0,o=d.cleanNode(e,this.config.NODE_STYLES);for(var i=0;i<this.originalNodes.length;i++)if(this.originalNodes[i].id==o.id){t=this.originalNodes[i],this.originalNodes[i]=o;break}void 0!==o.mathml&&""!=o.mathml&&(o=this.nodeToSVGMath(o)),void 0!==o.previewhtml&&""!=o.previewhtml&&(o=this.nodeToSVGHTML(o)),this.nodes.update(o),this.actionLogger.addToStateHistory({func:"editNode",param:{newNode:o,oldNode:t}})}isUniqueId(e){for(var t=0;t<this.originalNodes.length;t++)if(this.originalNodes[t].id==e)return!1;return!0}isUniqueEdgeId(e){for(var t=0;t<this.originalEdges.length;t++)if(this.originalEdges[t].id==e)return!1;return!0}lazyLoadNodes(e){null==e||e.length<3||(this.statusLogger.setStatusText("Downloading nodes..."),this.statusLogger.setStatusCursor("wait"),l.default.ajaxSetup({error:function(e,t){0==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading nodes failed (Check Your Network)</font>'),this.statusLogger.setStatusCursor("auto")):404==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading nodes failed (Requested URL not found)</font>'),this.statusLogger.setStatusCursor("auto")):500==e.status?(this.statusLogger.setStatusText('<font color="red">Downloading nodes failed (Internel Server Error)</font>'),this.statusLogger.setStatusCursor("auto")):(this.statusLogger.setStatusText('<font color="red">Downloading nodes failed (HTTP-Error-Code: '+e.status+")</font>"),this.statusLogger.setStatusCursor("auto"))}}),l.default.get(e,this.addNodesAndEdges.bind(this)))}openCluster(e){if(1==this.network.isCluster(e)){var t=this.network.body.nodes[e].label;this.network.openCluster(e);for(var o=[],i=0;i<this.clusterPositions[e][0].length;i++){var s=this.clusterPositions[e][0][i];o.push({id:s,x:this.clusterPositions[e][1][s].x,y:this.clusterPositions[e][1][s].y})}var n=this.allClusters.indexOf(e);n>-1&&this.allClusters.splice(n,1),this.actionLogger.addToStateHistory({func:"uncluster",param:{clusterId:e,nodes:o.map(e=>e.id),name:t}}),this.nodes.update(o),this.network.redraw()}}estimateExtraSVGHeight(e){return-1==e.indexOf("frac")&&-1==e.indexOf("under")&&e.indexOf("over"),0}nodeToSVGHTML(e){this.dom.$$("string_span").html(e.previewhtml||"");var t,o=this.dom.$$("string_span").width(),i=this.dom.$$("string_span").height();return this.dom.$$("string_span").html(""),t="image"==e.shape?'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+(o+16)+" "+(16+i)+'" width="'+(o+16)+'px" height="'+(16+i)+'px" preserveAspectRatio="none"><foreignObject x="8" y="8" width="'+(o+15)+'" height="'+i+'"><div xmlns="http://www.w3.org/1999/xhtml" style="font-size:18px;margin-left: auto;margin-right: auto;display: flex;align-items: center;justify-content: center">'+e.previewhtml+"</div></foreignObject></svg>":'<svg xmlns="http://www.w3.org/2000/svg" width="'+(30+o)+'px" height="'+(30+i)+'px" preserveAspectRatio="none"><foreignObject x="15" y="13" width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml">'+e.previewhtml+"</div></foreignObject></svg>",e.image="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t),e}nodeToSVGMath(e){this.dom.$$("string_span").html(e.mathml);var t,o=this.dom.$$("string_span").width(),i=this.dom.$$("string_span").height();if(this.dom.$$("string_span").html(""),"image"==e.shape){var s=i+this.estimateExtraSVGHeight(e.mathml);t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+(o+16)+" "+(16+s)+'" width="'+(o+16)+'px" height="'+(16+s)+'px" preserveAspectRatio="none"><foreignObject x="8" y="8" width="'+(o+15)+'" height="'+s+'">'+e.mathml+"</foreignObject></svg>"}else t='<svg xmlns="http://www.w3.org/2000/svg" width="'+(30+o)+'px" height="'+(30+i+this.estimateExtraSVGHeight(e.mathml))+'px" preserveAspectRatio="none"><foreignObject x="15" y="13" width="100%" height="100%">'+e.mathml+"</foreignObject></svg>";return e.image="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t),e}startConstruction(e=!1){console.log("Fixed0: "+e);for(var t={},o=0;o<this.edgesNameToHide.length;o++){var i=this.edgesNameToHide[o].type;1==this.edgesNameToHide[o].hidden&&(t[i]=!0)}console.log(this.originalNodes),this.internalOptimizer=new r.default(this.originalNodes,this.originalEdges,t,this.statusLogger),this.statusLogger.setStatusText("Constructing graph...");var s=0,n=0,d=0;console.log("Optimizer call done");for(var a=0;a<this.originalNodes.length;a++)""!=this.originalNodes[a].image&&null!=this.originalNodes[a].image&&n++,void 0!==this.originalNodes[a].x&&0!==this.originalNodes[a].x||d++;for(a=0;a<this.originalNodes.length;a++)if(this.hiddenNodes[this.originalNodes[a].id]=!1,""!=this.originalNodes[a].image&&null!=this.originalNodes[a].image){var h=((t,o)=>{t.mathml=o,this.nodeToSVGMath(t),++s==n&&(console.log("Fixed2: "+e),this.startRendering())}).bind(this,this.originalNodes[a]);l.default.get(this.originalNodes[a].image,h)}else null!=this.originalNodes[a].mathml&&this.originalNodes[a].mathml.length>10&&""!=this.originalNodes[a].mathml&&this.nodeToSVGMath(this.originalNodes[a]),void 0!==this.originalNodes[a].previewhtml&&""!=this.originalNodes[a].previewhtml&&this.nodeToSVGHTML(this.originalNodes[a]);d>this.originalNodes.length/2&&(e=!1),0==n&&(console.log("Fixed1: "+e+" "+d),this.startRendering(e))}startRendering(e){if(void 0===e&&(e=!1),this.statusLogger.setStatusText("Rendering graph..."),0==e){for(var t={},o=0;o<this.edgesNameToHide.length;o++){var i=this.edgesNameToHide[o].type;1==this.edgesNameToHide[o].hidden&&(t[i]=!0)}if(console.log("Do optimizing"),void 0===this.config.THEORY_GRAPH_OPTIONS.layout||void 0===this.config.THEORY_GRAPH_OPTIONS.layout.ownLayoutIdx||1==this.config.THEORY_GRAPH_OPTIONS.layout.ownLayoutIdx){var s=new r.default(this.originalNodes,this.originalEdges,t,this.statusLogger),d=parseInt(this.dom.getElementById("nodeSpacingBox").value,10);this.originalNodes.length+this.originalEdges.length>3e3?s.weaklyHierarchicalLayout(500,d):this.originalNodes.length+this.originalEdges.length>2e3?s.weaklyHierarchicalLayout(700,d):s.weaklyHierarchicalLayout(1e3,d),s.destroy()}else 2==this.config.THEORY_GRAPH_OPTIONS.layout.ownLayoutIdx?((s=new r.default(this.originalNodes,this.originalEdges,t,this.statusLogger)).GenerateRandomSolution(),d=parseInt(this.dom.getElementById("nodeSpacingBox").value,10),this.originalNodes.length+this.originalEdges.length>3e3?s.SolveUsingForces(200,d):this.originalNodes.length+this.originalEdges.length>2e3?s.SolveUsingForces(400,d):s.SolveUsingForces(600,d),s.destroy()):4==this.config.THEORY_GRAPH_OPTIONS.layout.ownLayoutIdx&&((s=new r.default(this.originalNodes,this.originalEdges,t,this.statusLogger)).GenerateRandomSolution(),d=parseInt(this.dom.getElementById("nodeSpacingBox").value,10),this.originalNodes.length+this.originalEdges.length>3e3?s.waterDrivenLayout(200,d):this.originalNodes.length+this.originalEdges.length>2e3?s.waterDrivenLayout(400,d):s.waterDrivenLayout(600,d),s.destroy())}for(var a=0;a<this.originalEdges.length;a++)this.originalEdges[a].hidden=!1;for(o=0;o<this.edgesNameToHide.length;o++)for(a=0;a<this.originalEdges.length;a++)(i=this.edgesNameToHide[o].type)!=this.originalEdges[a].style&&"graph"+i!=this.originalEdges[a].style||(this.originalEdges[a].hidden=this.edgesNameToHide[o].hidden);for(a=0;a<this.originalNodes.length;a++)this.originalNodes[a].fromConnected=[],this.originalNodes[a].connectedNodes=[],this.originalNodes[a].connectedNodesById={},this.originalNodes[a].toConnected=[];console.log("Create network"),console.log(this.originalNodes),this.nodes=new n.DataSet(this.originalNodes),this.edges=new n.DataSet(this.originalEdges);var h={nodes:this.nodes,edges:this.edges};this.network=new n.Network(this.dom.getElementById(this.containerName),h,this.config.THEORY_GRAPH_OPTIONS),0==this.config.THEORY_GRAPH_OPTIONS.physics.enabled&&(this.statusLogger.setStatusCursor("auto"),this.statusLogger.setStatusText('<font color="green">Received '+this.originalNodes.length+" nodes</font>")),this.network.on("afterDrawing",()=>{null!=this.onConstructionDone&&1==this.doCallAfterConstruction&&(this.doCallAfterConstruction=!1,this.onConstructionDone())}),this.network.on("click",e=>{this.dom.$$("tooltip-container").hide(10),l.default(e.target).parents(".custom-menu").length>0||this.dom.$(".custom-menu").hide(10),0==this.manipulateSelectedRegion(e.pointer.canvas)&&this.selectRegion(e.pointer.canvas),1==this.addNodeToRegion&&0==this.allNodeRegions[this.addNodeRegionId].selected&&(this.addNodeToRegion=!1,this.statusLogger.setStatusCursor("auto"))}),this.network.on("selectNode",e=>{if(1!=this.manualFocus){if(1==this.addNodeToRegion&&e.nodes.length>0&&1==this.allNodeRegions[this.addNodeRegionId].selected){for(var t=0;t<e.nodes.length;t++)this.allNodeRegions[this.addNodeRegionId].nodeIds.push(e.nodes[t]);this.network.redraw()}}else this.focusOnNodes()}),this.dom.$(".custom-menu li").click(e=>{var t=this.network.getSelectedNodes(),o=this.network.body.nodes[t[0]];if(null==o){for(var i=0;i<this.originalNodes.length;i++)if(this.originalNodes[i].id==t[0]){o=this.originalNodes[i];break}}else o=o.options||{};var s=this.network.getSelectedEdges(),n=void 0;for(i=0;i<this.originalEdges.length;i++)if(this.originalEdges[i].id==s[0]){n=this.originalEdges[i];break}var d=void 0;if(null!=n&&(d=n),null!=o&&(d=o),null!=d)switch(l.default(e.target).attr("data-action")){case"openWindow":window.open(this.config.serverUrl+d.url);break;case"showURL":alert(this.config.serverUrl+d.url);break;case"openCluster":this.openCluster(d.id);break;case"inferType":case"showDecl":alert("Not implemented yet!");break;case"childNodes":this.lazyLoadNodes(o.childsURL)}this.dom.$(".custom-menu").hide(10)}),this.network.on("oncontext",e=>{this.dom.$$("tooltip-container").hide(10),this.dom.$(".custom-menu").hide(10);var t=this.network.getNodeAt({x:e.pointer.DOM.x,y:e.pointer.DOM.y});if(null!=t)return this.network.selectNodes([t]),void this.dom.$(".custom-menu").finish().show(10).css({top:1*e.pointer.DOM.y+20+"px",left:1*e.pointer.DOM.x+16+this.dom.getElementById("mainbox").offsetLeft+"px"});var o=this.network.getEdgeAt({x:e.pointer.DOM.x,y:e.pointer.DOM.y});if(null!=typeof o&&null!=o){this.network.selectEdges([o]);for(var i=void 0,s=0;s<this.originalEdges.length;s++)if(this.originalEdges[s].id==o){i=this.originalEdges[s];break}null!=i&&void 0!==i.clickText&&this.dom.$$("tooltip-container").finish().show(10).html(i.clickText).css({top:1*e.pointer.DOM.y+20+"px",left:1*e.pointer.DOM.x+16+this.dom.getElementById("mainbox").offsetLeft+"px"})}}),this.network.on("stabilizationIterationsDone",e=>{this.network.stopSimulation(),this.network.setOptions({physics:{enabled:!1}}),this.statusLogger.setStatusCursor("auto"),this.statusLogger.setStatusText('<font color="green">Received '+this.originalNodes.length+" nodes</font>")}),this.network.on("beforeDrawing",e=>{this.drawAllColoredRegions(e)}),this.network.on("afterDrawing",e=>{this.drawAllColoredRegionsOnCanvas(e)}),this.network.once("initRedraw",()=>{0===this.lastClusterZoomLevel&&(this.lastClusterZoomLevel=this.network.getScale()),this.statusLogger.setStatusCursor("auto")})}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(14));t.default=class extends s.default{constructor(e,t,o){super(e,t,o)}cluster(e=10,t=10,o=200,i=1e3){for(var s=[],n=0;n<e;n++)s.push({data:[],modularity:0}),s[n].data=this.generateRandomSolution(),s[n].modularity=this.calculateModularity(s[n].data);for(var d=0;d<t;d++){for(console.log("round: "+d+"/"+t),n=1;n<e;n++)for(var a=0;a<o;a++)if(Math.random()<.95){var r=Math.floor(Math.random()*this.myAllNodes.length);s[n].modularity=this.findBestNewClusterForNode(r,s[n].data,s[n].modularity)}else{r=Math.floor(Math.random()*this.myAllNodes.length);var l=Math.floor(Math.random()*this.myAllNodes.length);s[n].modularity=this.calculateModularityChangeOneNode(r,s[n].data,l,s[n].modularity)}for(s.sort(function(e,t){return t.modularity-e.modularity}),console.log(s[0].modularity),console.log(s[1].modularity),console.log(s[2].modularity),console.log(" "),n=e/2|0;n<e;n++){var h=Math.floor(Math.random()*((s.length>>1)-1)),g=Math.floor(Math.random()*((s.length>>1)-1));Math.random()<.75?(s[n].data=this.combineTwoSolutionsRandom(s[h].data,s[g].data),s[n].modularity=this.calculateModularity(s[n].data)):(s[n].data=this.combineTwoSolutionsClusterbased(s[h].data,s[g].data),s[n].modularity=this.calculateModularity(s[n].data))}}for(n=0;n<e;n++)for(a=0;a<i;a++)r=Math.floor(Math.random()*this.myAllNodes.length),s[n].modularity=this.findBestNewClusterForNode(r,s[n].data,s[n].modularity);return s.sort(function(e,t){return t.modularity-e.modularity}),console.log(s[0].modularity),console.log(s[1].modularity),console.log(s[2].modularity),s[0].data}combineTwoSolutionsRandom(e,t){for(var o=[],i=0;i<e.length;i++)Math.random()<.5?o.push(e[i]):o.push(t[i]);return o}combineTwoSolutionsClusterbased(e,t){for(var o=[],i=0,s=0;s<e.length;s++)o.push(e[s]),i=Math.max(i,e[s]);i++;var n=[],d=[];for(s=0;s<t.length;s++)void 0===d[t[s]]&&(d[t[s]]=1,Math.random()<.1&&(n[t[s]]=1));for(s=0;s<t.length;s++)void 0!==n[t[s]]&&(o[s]=t[s]+i);return o}generateRandomSolution(){var e=[];if(Math.random()<.75){for(var t=0;t<this.myAllNodes.length;t++)e[t]=t;return e}for(t=0;t<this.myAllNodes.length;t++)e[t]=-1;for(t=0;t<this.myAllNodes.length;t++)if(-1==e[t]){var o=t+this.myAllNodes.length;e[t]=o;for(var i=0;i<this.myAllNodes[t].connectedNodes.length;i++)(Math.random()<.5||this.myAllNodes[t].connectedNodes.length<3)&&(e[this.myAllNodes[t].connectedNodes[i].idx]=o)}for(t=0;t<this.myAllNodes.length;t++)-1==e[t]&&(e[t]=t);return e}findBestNewClusterForNode(e,t,o){for(var i=[],s=-1/0,n=0,d=t[e],a=t.slice(),r=0;r<t.length;r++)if(void 0===i[t[r]]){i[t[r]]=1;var l=t[r],h=this.calculateModularityChangeOneNode(e,a,l,o);a[e]=d,h>s&&(s=h,n=l)}return t[e]=n,s}calculateModularityChangeOneNode(e,t,o,i){for(var s=2*this.edgesCount,n=0;n<this.myAllNodes.length;n++)t[e]==t[n]&&e!=n&&(i-=(void 0===this.myAllNodes[e].connectedNodesById[this.myAllNodes[n].id]?0:1)-this.myAllNodes[e].connectedNodes.length*this.myAllNodes[n].connectedNodes.length/s);for(n=0;n<this.myAllNodes.length;n++)t[n]==t[e]&&e!=n&&(i-=(void 0===this.myAllNodes[n].connectedNodesById[this.myAllNodes[e].id]?0:1)-this.myAllNodes[n].connectedNodes.length*this.myAllNodes[e].connectedNodes.length/s);for(t[e]=o,n=0;n<this.myAllNodes.length;n++)t[e]==t[n]&&e!=n&&(i+=(void 0===this.myAllNodes[e].connectedNodesById[this.myAllNodes[n].id]?0:1)-this.myAllNodes[e].connectedNodes.length*this.myAllNodes[n].connectedNodes.length/s);for(n=0;n<this.myAllNodes.length;n++)t[n]==t[e]&&e!=n&&(i+=(void 0===this.myAllNodes[n].connectedNodesById[this.myAllNodes[e].id]?0:1)-this.myAllNodes[n].connectedNodes.length*this.myAllNodes[e].connectedNodes.length/s);return i}calculateModularity(e){for(var t=0,o=2*this.edgesCount,i=0;i<this.myAllNodes.length;i++)for(var s=0;s<this.myAllNodes.length;s++)e[i]==e[s]&&i!=s&&(t+=(void 0===this.myAllNodes[i].connectedNodesById[this.myAllNodes[s].id]?0:1)-this.myAllNodes[i].connectedNodes.length*this.myAllNodes[s].connectedNodes.length/o);return t}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(14));t.default=class extends s.default{constructor(e,t,o,i){super(e,t,i,o),this.DependencyWidth=30,this.DependencyHeight=30,this.field={},this.myWidth=12e3,this.myHeight=12e3}destroy(){super.destroy(),this.field={}}GenerateRandomSolution(){var e=[],t=0;for(t=0;t<this.myAllNodes.length;t++)this.InsertNodeAtGoodPosition(this.myAllNodes[t],e)}UpdateFieldColision(e,t,o=1){this.field[t*this.myWidth+e]=o}InsertNodeAtGoodPosition(e,t,o=5){var i,s,d=this.DependencyWidth/2,a=this.DependencyHeight/2,r=0,l=0,h=1e7,g=e.connectedNodes;if(null==g||0==g.length){var c=0;do{c++,r=Math.random()*this.myWidth/this.DependencyWidth|0,l=Math.random()*this.myHeight/this.DependencyHeight|0}while(1==this.field[l*this.myWidth+r]&&c<10);return e.x=r*this.DependencyWidth,e.y=l*this.DependencyHeight,void this.UpdateFieldColision(r,l)}for(c=0;c<o;c++)if(i=Math.random()*this.myWidth/this.DependencyWidth|0,s=Math.random()*this.myHeight/this.DependencyHeight|0,1!=this.field[s*this.myWidth+i]){for(var u=0,m=i*this.DependencyWidth,p=s*this.DependencyHeight,f=0;f<g.length;f++)m>g[f].x?u+=this.GetLineColision(new n(g[f].x+d,g[f].y+a,m+d,p+a),t):u+=this.GetLineColision(new n(m+d,p+a,g[f].x+d,g[f].y+a),t);h>u&&(h=u,r=i,l=s)}for(e.x=r*this.DependencyWidth,e.y=l*this.DependencyHeight,this.UpdateFieldColision(r,l),f=0;f<g.length;f++)e.x>g[f].x?t.push(new n(g[f].x+d,g[f].y+a,e.x+d,e.y+a)):t.push(new n(e.x+d,e.y+a,g[f].x+d,g[f].y+a))}ccw(e,t,o,i,s,n){var d=(i-t)*(s-o)-(o-e)*(n-i);return 0==d?0:d>0?1:2}findRandomPath(e){if(void 0!==e){for(var t=[e],o=[];t.length>0;){(a=t.pop()).overallLength+=o.length,a.overallVisited+=1,o.push(a);var i=Math.floor(Math.random()*a.connectedNodes.length);if(0==a.connectedNodes.length)return o;var s=a.connectedNodes[0];if(Math.floor(100*Math.random())>66)for(var n=0;n<a.connectedNodes.length;n++)null!=a.connectedNodes[n].connectedNodes&&null!=s&&a.connectedNodes[n].connectedNodes.length>s.connectedNodes.length&&1!=a.connectedNodes[n].visited&&(s=a.connectedNodes[n],i=n);for(n=0;1==a.connectedNodes[i].visited||null==a.connectedNodes[i].connectedNodes||0==a.connectedNodes[i].connectedNodes.length;)if(i=n,++n>=a.connectedNodes.length)return o;a.connectedNodes[i].visited=!0,t.push(a.connectedNodes[i])}for(var d=0;d<e.connectedNodes.length;d++)var a=e.connectedNodes[d];return o}}waterDrivenLayout(e,t,o=200,i,s){void 0!==s&&this.mapEdgesIntoNodes(s,i);for(var n=0;n<this.myAllNodes.length;n++)(a=this.myAllNodes[n]).overallWeight=0;var d=[];for(n=0;n<this.myAllNodes.length;n++){var a=this.myAllNodes[n];d[n]=0,a.overallWeight=.5,0==a.fromConnected.length&&(a.overallWeight=1),0==a.toConnected.length&&(a.overallWeight=0)}for(var r=0;r<e/10;r++){var l=0;for(n=0;n<this.myAllNodes.length;n++){for(var h=(a=this.myAllNodes[n]).overallWeight,g=0;g<a.connectedNodes.length;g++)h+=a.connectedNodes[g].overallWeight/(1+a.connectedNodes.length);d[n]=h,l+=d[n]}for(n=0;n<this.myAllNodes.length;n++)d[n]/=l,(a=this.myAllNodes[n]).overallWeight=d[n],d[n]=0}var c=1/0,u=-1/0;for(n=0;n<this.myAllNodes.length;n++)a=this.myAllNodes[n],c=Math.min(a.overallWeight,c),u=Math.max(a.overallWeight,u);for(n=0;n<this.myAllNodes.length;n++)(a=this.myAllNodes[n]).overallWeight=((a.overallWeight-c)/(u-c)-.5)*o*2;console.log(this.myAllNodes),this.SolveUsingForces(e,t,!0,!1,.9,30,!0)}weaklyHierarchicalLayout(e,t,o=!1,i=.9,s=30){for(var n=0;n<this.myAllNodes.length;n++)(g=this.myAllNodes[n]).overallLength=0,g.overallVisited=0;var d=40*t,a=40*t,r=[],l=0,h=this.myAllNodes[0];for(n=0;n<this.myAllNodes.length;n++){var g;(g=this.myAllNodes[n]).forcesFixed=!1;var c=Math.abs(g.toConnected.length-g.fromConnected.length);void 0===r[c]&&(r[c]=[]),r[c].push(g),c>l&&(l=c),h.toConnected<g.toConnected&&(h=g)}for(var u=[],m=0;m<16*e;m++){for(m%50==0&&this.logger.setStatusText("Beautify Layout: Iteration "+m+" of "+2*e+"..."),n=0;n<this.myAllNodes.length;n++)this.myAllNodes[n].visited=!1;var p=this.findRandomPath(h);void 0!==p&&p.length>u.length&&(u=p.slice())}for(n=0;n<this.myAllNodes.length;n++)if(null==this.myAllNodes[n].overallLength||0==this.myAllNodes[n].overallVisited){if(0!=this.myAllNodes[n].connectedNodes.length)for(m=0;m<this.myAllNodes[n].connectedNodes.length;m++)this.myAllNodes[n].overallLength+=this.myAllNodes[n].connectedNodes[m].overallLength;0==this.myAllNodes[n].overallLength||0==this.myAllNodes[n].connectedNodes.length?this.myAllNodes[n].overallLength=Math.floor(20*Math.random()):this.myAllNodes[n].overallLength=Math.floor(this.myAllNodes[n].overallLength/this.myAllNodes[n].connectedNodes.length)}else this.myAllNodes[n].overallLength=Math.floor(this.myAllNodes[n].overallLength/this.myAllNodes[n].overallVisited);var f=[],y=[];for(n=0;n<2*this.myAllNodes.length+20;n++)f[n]=0,y[n]=0;var v=0;for(m=0;m<this.myAllNodes.length;m++)(E=this.myAllNodes[m].overallLength)>v&&(v=E);v+=1;var N=[];for(m=0;m<this.myAllNodes.length;m++)this.myAllNodes[m].overallLength>=0&&(N[this.myAllNodes[m].overallLength]=this.myAllNodes[m].overallLength);N[v]=v;var w=0;for(m=0;m<=v+1;m++)void 0===N[m]||N[m]<0?w+=1:N[m]-=w;for(m=0;m<this.myAllNodes.length;m++)(null==this.myAllNodes[m].toConnected||0==this.myAllNodes[m].toConnected.length||this.myAllNodes[m].fromConnected.length-this.myAllNodes[m].toConnected.length>this.myAllNodes.length/3)&&(this.myAllNodes[m].overallLength=v),f[E=N[this.myAllNodes[m].overallLength]]+=a,this.myAllNodes[m].x=f[E],this.myAllNodes[m].y=E*d,console.log("Level["+E+"; real:"+this.myAllNodes[m].overallLength+"]: "+this.myAllNodes[m].x+" "+this.myAllNodes[m].y);for(m=0;m<this.myAllNodes.length;m++){this.myAllNodes[m].connectedNodes.length>1&&(this.myAllNodes[m].forcesFixed=!0);var E=N[this.myAllNodes[m].overallLength];this.myAllNodes[m].x-=f[E]/2}this.SolveUsingForces(2*e,t,!1,o,i,s),this.SolveUsingForces(5,t,!0,o,i,3)}SolveUsingForces(e,t,o=!0,i=!1,s=.9,n=30,d=!1){if(1==o)for(var a=0;a<this.myAllNodes.length;a++)(p=this.myAllNodes[a]).forcesFixed=!1;for(var r=1e6,l=n,h=0,g=Math.max(Math.min((4*this.myAllNodes.length+this.edgesCount/2.5)/2*.5*t/7,300),70),c=g*g,u=0;u<e;u++){u%100==0&&this.logger.setStatusText("Beautify Layout: Iteration "+u+" of "+e+"...");var m=r;for(r=0,a=0;a<this.myAllNodes.length;a++){var p;if(!1===(p=this.myAllNodes[a]).forcesFixed&&1!=p.hidden){1==d&&void 0!==p.overallWeight?(p.dispX=0,p.dispY=p.overallWeight):(p.dispX=0,p.dispY=0);for(var f=0;f<this.myAllNodes.length;f++)if((w=this.myAllNodes[f]).graphNumber==p.graphNumber&&p!=w&&null!=w.connectedNodes&&w.connectedNodes.length>0){var y=w.x-p.x,v=w.y-p.y,N=-c/(E=Math.sqrt(y*y+v*v)+.001);void 0!==p.membership&&void 0!==w.membership&&w.membership!=p.membership&&(N*=1.5),p.dispX+=y/E*N,p.dispY+=v/E*N}for(f=0;f<p.connectedNodes.length;f++){y=(w=p.connectedNodes[f]).x-p.x,v=w.y-p.y;var w,E,A=(E=Math.sqrt(y*y+v*v)+.001)*E/g;void 0!==p.membership&&void 0!==w.membership&&w.membership==p.membership&&(A*=5),p.dispX+=y/E*A,p.dispY+=v/E*A}var S=Math.sqrt(p.dispX*p.dispX+p.dispY*p.dispY)+.001;p.x=p.x+p.dispX/S*l,p.y=p.y+p.dispY/S*l,1==i&&(p.x=Math.max(48,Math.min(p.x,this.myWidth-48)),p.y=Math.max(8,Math.min(p.y,this.myHeight-32))),r+=S*S}}r<m?++h>=5&&(h=0):h=0}this.placeGraphs()}placeGraphs(){for(var e=this.countNodesInGraph.length+1>>1,t=[],o=0;o<=this.myAllNodes.length;o++)t[o]=[],t[o][0]=1e6,t[o][1]=1e6,t[o][2]=-1e6,t[o][3]=-1e6;for(o=0;o<this.myAllNodes.length;o++)t[this.myAllNodes[o].graphNumber][0]=Math.min(t[this.myAllNodes[o].graphNumber][0],this.myAllNodes[o].x),t[this.myAllNodes[o].graphNumber][1]=Math.min(t[this.myAllNodes[o].graphNumber][1],this.myAllNodes[o].y),t[this.myAllNodes[o].graphNumber][2]=Math.max(t[this.myAllNodes[o].graphNumber][2],this.myAllNodes[o].x+100),t[this.myAllNodes[o].graphNumber][3]=Math.max(t[this.myAllNodes[o].graphNumber][3],this.myAllNodes[o].y+100);var i=[],s=0,n=0,d=0;for(o=1;o<t.length;o++)o%e==0&&(s=0,n+=d,d=0),i[o]=[],i[o][0]=s,i[o][1]=n,s+=t[o][2]-t[o][0]+10,d=Math.max(d,t[o][3]-t[o][1]+10);for(o=0;o<this.myAllNodes.length;o++)this.myAllNodes[o].x=i[this.myAllNodes[o].graphNumber][0]+(this.myAllNodes[o].x-t[this.myAllNodes[o].graphNumber][0]),this.myAllNodes[o].y=i[this.myAllNodes[o].graphNumber][1]+(this.myAllNodes[o].y-t[this.myAllNodes[o].graphNumber][1])}GetLineColision(e,t){for(var o=0,i=0;i<t.length;i++)(e.xEnd!=t[i].xEnd&&e.xStart!=t[i].xEnd&&e.xEnd!=t[i].xStart&&e.xStart!=t[i].xStart||e.yEnd!=t[i].yEnd&&e.yStart!=t[i].yEnd&&e.yEnd!=t[i].yStart&&e.yStart!=t[i].yStart)&&this.ccw(e.xStart,e.yStart,e.xEnd,e.yEnd,t[i].xStart,t[i].yStart)!=this.ccw(e.xStart,e.yStart,e.xEnd,e.yEnd,t[i].xEnd,t[i].yEnd)&&this.ccw(t[i].xStart,t[i].yStart,t[i].xEnd,t[i].yEnd,e.xStart,e.yStart)!=this.ccw(t[i].xStart,t[i].yStart,t[i].xEnd,t[i].yEnd,e.xEnd,e.yEnd)&&o++;return o}};class n{constructor(e,t,o,i){this.xStart=e,this.yStart=t,this.xEnd=o,this.yEnd=i}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(6));class n{constructor(e){this.config=e;var t,o=this.config.preferences.mainContainer;if(!o)throw new Error("Can not find mainElement");this.mainElement=o,this.mainElement$=s.default(o),this.mainElement.innerHTML=`\n      <div id="${t=e.preferences.prefix}mySidenav" class="tgview sidenav">\n         <a href="javascript:void(0)" id="${t}closeNav" class="closebtn">&times;</a>\n         <div id="${t}theory_tree_div" name="${t}theory_tree_div" class="tgview theoryTreeClass"  style="float:left;height:82%;">\n            <span style="font-weight: bold; font-size: 110%;"> MathHub Archives </span>\n            <div id="${t}theory_tree" ></div>\n         </div>\n      </div>\n      <div id="${t}mainbox" style="float:left;width:99%; padding-left:10px; ">\n         <div id="${t}shareIcons" class="tgview jssocials" style="position: absolute;left:40px; text-align: center;width:95.5%"></div>\n         <div id="${t}menuButtonsDiv">\n            <button style="font-size:24px;cursor:pointer;margin:0px;" id="${t}leftMenuButton" class="tgview myButton">&gt;</button>\n            <button style="font-size:24px;cursor:pointer;right:16px;margin:0px;position:absolute" id="${t}rightMenuButton" class="tgview myButton">&lt;</button>\n            <br /><br />\n         </div>\n         <div id="${t}mySidenav2" class="tgview sidenav2">\n            <a href="javascript:void(0)" id="${t}closeNav2" class="closebtn" >&times;</a>\n            <div class="tgview toolSelector" id="${t}toolSelector">\n               <div id="${t}generalMenu" class="tgview generalMenu" name="${t}generalMenu">\n                  <div id="${t}edgesShowHideDiv" name="${t}edgesShowHideDiv" style="max-height:200px; overflow:auto; width:99%">\n                  </div>\n                  <br /><br />\n                  <select name="${t}nodeSpacingBox" id="${t}nodeSpacingBox"  >\n                     <option value="0.66">Tiny Node-Spacing</option>\n                     <option value="1.5">Small Node-Spacing</option>\n                     <option value="3">Smaller Node-Spacing</option>\n                     <option value="4" selected>Normal Node-Spacing</option>\n                     <option value="5">Bigger Node-Spacing</option>\n                     <option value="7">Big Node-Spacing</option>\n                     <option value="10">Huge Node-Spacing</option>\n                  </select>\n                  <select name="${t}layoutBox" id="${t}layoutBox"  >\n                     <option value="0">Strictly Hierarchical Layout</option>\n                     <option value="1" selected>Semi Hierarchical Layout</option>\n                     <option value="2">Forces Driven Layout</option>\n               <option value="3">Manual Focus Layout</option>\n         <option value="4">Water Driven Layout</option>\n                  </select>\n                  <br /><br />\n                  \x3c!--\n                     <button onClick="changeMethod(0);" title="Standard Layout" class="tgview myButton" style="width:32px;height:26px"><div style="margin-top:2px" class="tgview standardIcon"></div></button>\n                     <button onClick="changeMethod(1);" title="Hierarchical Layout"  class="tgview myButton" style="width:32px;height:26px"><div style="margin-top:2px" class="hierarchicalIcon"></div></button>\n                     --\x3e\n                  <div style="float:left" class="tgview colorPicker" id="${t}colorPicker" name="${t}colorPicker">\n                  </div>\n                  <br /><br />\n                  <button id="${t}undoButton"  title="Undo last Action" class="tgview myButton" style="width:32px;height:26px">\n                     <div style="margin-top:2px" class="tgview undoIcon"></div>\n                  <button id="${t}redoButton" title="Redo last Action" class="tgview myButton" style="width:32px;height:26px;margin-left:4px;">\n                     <div style="margin-top:2px" class="tgview redoIcon"></div>\n                  <button id="${t}selectionModeButton"  title="Switch Selection Mode" class="tgview myButton" style="width:32px;height:26px;margin-left:4px;">\n                     <div style="margin-top:2px" class="tgview crosshairIcon"></div>\n                  <button id="${t}downloadButton" title="Download Graph" class="tgview myButton" style="width:32px;height:26px;margin-left:4px;margin-right:4px;">\n                     <div style="margin-top:2px" class="tgview downloadIcon"></div>\n                  <button id="${t}clusterButton"  class="tgview myButton">Cluster Nodes</button>\n                  <button id="${t}cageButton" class="tgview myButton">Cage Nodes</button>\n            <button id="${t}manualHideButton"  class="tgview myButton">Hide selected Nodes</button>\n            <button id="${t}manualShowButton" class="tgview myButton">Show all manual hidden Nodes</button>\n                  <button id="${t}helpButton"  class="tgview myButton">Help</button>\n                  <button id="${t}selectNodes" class="tgview myButton">Select Nodes By Pathname</button>\n               <button id="${t}clusterNodesColor"  class="tgview myButton">Cluster Nodes</button>\n                  <br />\n                  <br />\n                  Upload JSON:\n                  <input type="file" id="${t}jsonLoader" name="${t}jsonLoader"/>\n                  <br />\n                  <br />\n                  <form action="">\n                     <input type="radio" id="${t}iframeRadio" name="${t}embedding"  value="iframe"> Embed graph in HTML using IFrame (recommended)<br>\n                     <input type="radio" id="${t}htmlRadio" name="${t}embedding"  value="html"> Embed graph in HTML using JS<br>\n                     <input type="radio" id="${t}parameterRadio" name="${t}embedding"  value="parameter"> Embed graph in URI<br>\n                     <input type="radio" id="${t}uriRadio" name="${t}embedding"  value="uri"> Download graph from server (default) <br>\n                     <input type="radio" id="${t}jsonRadio" name="${t}embedding" value="harddisk"> Save graph to harddisk as JSON\n                     <br />\n                     <br />\n                     <textarea rows="2" id="${t}uriTextarea" cols="42" readonly></textarea>\n                     <br />\n                     <textarea rows="4" id="${t}informationTextarea" cols="42" readonly > </textarea>\n                  </form>\n               </div>\n            </div>\n         </div>\n         <div id="${t}wholeNetwork" class="tgview wholeNetwork">\n            <div id="${t}mynetwork" style="top:0px;left:0px;position: absolute; -moz-user-select: none; width: 100%; height: 100%;">\n            </div>\n         <div id="${t}mynetworkLegend" style=" border: 2px dashed #D1D1D1; border-radius: 5px;opacity: 0.95; top:95%;left:0px;position: absolute; -moz-user-select: none; width: 99.9%; height: 5%;background-color:#FBFBFB">\n            </div>\n            <canvas id="${t}toolCanvas" style="display:none;z-index:1000;top:0px;left:0px;position: absolute;" width="1200" height="600"></canvas>\n            <div id="${t}statusBar" style="z-index:1001;top:40px;left:8px;position: absolute;">\n               ...\n            </div>\n         </div>\n      </div>\n      <div id="${t}helpDialog" title="Help">\n         <p>You can select more than one node by holding CTRL and clicking on nodes to select! <br>\n            You can also draw rectangles around nodes to select them by activating "Selection Mode".\n         </p>\n      </div>\n      <p></p>\n      <span id='${t}string_span' style='float:left;font-size: 17px; display:none'></span>\n      <div id="${t}network-popUp" class="tgview network-popup">\n         <span id="${t}operation" class="tgview operation">node</span> <br>\n         <table style="margin:auto;" class="tgview legend_table">\n            <tr>\n               <td>Id</td>\n               <td><input id="${t}node-id" value="new value" /></td>\n            </tr>\n            <tr>\n               <td>Label</td>\n               <td><input id="${t}node-label" value="new value" /></td>\n            </tr>\n            <tr>\n               <td>URL</td>\n               <td><input id="${t}node-url" value="new value" /></td>\n            </tr>\n            <tr>\n               <td>MathML</td>\n               <td><textarea rows="4" cols="26" id="${t}node-mathml"></textarea></td>\n            </tr>\n            <tr>\n               <td>Class</td>\n               <td><select id="${t}node-style"></select></td>\n            </tr>\n         </table>\n         <input type="button" value="save" id="${t}saveButton" />\n         <input type="button" value="cancel" id="${t}cancelButton" />\n      </div>\n      <div id="${t}network-edge-popUp" class="tgview network-edge-popUp">\n         <span id="${t}edge-operation" class="tgview edge-operation">edge</span> <br>\n         <table style="margin:auto;" class="tgview legend_table">\n            <tr>\n               <td>Id</td>\n               <td><input id="${t}edge-id" value="new value" /></td>\n            </tr>\n            <tr>\n               <td>Label</td>\n               <td><input id="${t}edge-label" value="" /></td>\n            </tr>\n            <tr>\n               <td>URL</td>\n               <td><input id="${t}edge-url" value="" /></td>\n            </tr>\n            <tr>\n               <td>Class</td>\n               <td><select id="${t}edge-style"></select></td>\n            </tr>\n         </table>\n         <input type="button" value="save" id="${t}edge-saveButton" />\n         <input type="button" value="cancel" id="${t}edge-cancelButton" />\n      </div>\n      <ul class='tgview custom-menu' style="z-index:100">\n         <li data-action="openWindow">Open Theory</li>\n         <li data-action="showURL">Show URI</li>\n         <li data-action="inferType">Infer Type</li>\n         <li data-action="showDecl">Show Declaration</li>\n         <li data-action="openCluster">Open Cluster</li>\n         <li data-action="childNodes">Get Child-Nodes</li>\n      </ul>\n      <ul class='tgview custom-menu-side' id="${t}side-menu" style="z-index:2000">\n      </ul>\n      <div id="${t}tooltip-container" class="tgview custom-tooltip" style="z-index:101"></div>\n   `}destroy(){this.mainElement$.empty()}getElementById(e,t=!1){e.startsWith(this.config.preferences.prefix)&&console.warn("Possibly incorrect use of DOMConstruct.getElementById("+n.formatSelector(e)+"): Id of element to fetch starts with prefix. ");const o=document.getElementById(this.config.preferences.prefix+e);if(!o)throw new Error("Element with ID "+e+" does not exist");return t||this.mainElement.contains(o)||console.warn("Insecure use of DOMConstruct.getElementById("+n.formatSelector(e)+"): Element with ID "+e+" is not contained within mainElement"),o}$$(e,t=!1){return s.default(this.getElementById(e,t))}$(e,t=!1){e.startsWith("#")&&console.warn("Insecure use of DOMConstruct.$("+n.formatSelector(e)+"): Fetch elements by id using DOMConstruct.$$() to add prefixes. ");const o=this.mainElement$.find(e);if(o.length>0)return o;const i=s.default(e);return t||(i.length>0?console.warn("Insecure use of DOMConstruct.$("+n.formatSelector(e)+"): No element found inside of mainElement. "):console.warn("Insecure use of DOMConstruct.$("+n.formatSelector(e)+"): Element not found. ")),i}static formatSelector(e){return"'"+e.replace("\\","\\\\").replace("'","\\'")+"'"}}t.default=n},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(12)),n=o(13);t.default=class{constructor(e,t,o,i){this.config=o,this.statusLogger=i,this.originalNodes=[],this.originalEdges=[],this.nodes=null,this.edges=null,this.smallNodeSize=5,this.bigNodeSize=130,this.container=e.getElementById(t)}destroy(){this.edges&&this.edges.clear(),this.nodes&&this.nodes.clear(),this.network&&(this.network.destroy(),this.network=void 0),this.originalEdges=[],this.originalNodes=[]}load(e,t){const o=[],i=[];for(var s=0;s<e.length;s++){var d="Node";void 0!==this.config.NODE_STYLES[e[s]]&&(d=this.config.NODE_STYLES[e[s]].alias),o.push({id:1e5+s+"",style:e[s],label:d,widthConstraint:{minimum:this.bigNodeSize,maximum:this.bigNodeSize}})}for(s=0;s<t.length;s++){d="Default Edge";var a=t[s];void 0!==this.config.ARROW_STYLES[a]?d=this.config.ARROW_STYLES[a].alias:(a=t[s].replace(/graph/i,""),void 0!==this.config.ARROW_STYLES[a]&&(d=this.config.ARROW_STYLES[a].alias)),o.push({id:2e5+s+"",label:"N",widthConstraint:{minimum:this.smallNodeSize,maximum:this.smallNodeSize}}),o.push({id:21e4+s+"",label:"N",widthConstraint:{minimum:this.smallNodeSize,maximum:this.smallNodeSize}}),i.push({id:3e5+s+"",style:a,label:d,from:2e5+s+"",to:21e4+s+""})}this.originalEdges.push(...i.map(e=>n.cleanEdge(e,this.config.ARROW_STYLES))),this.originalNodes.push(...o.map(e=>n.cleanNode(e,this.config.NODE_STYLES))),this.startRendering()}startRendering(){console.log(this.originalNodes),this.statusLogger.setStatusText("Rendering Legend..."),this.nodes=new s.default.DataSet(this.originalNodes),this.edges=new s.default.DataSet(this.originalEdges),this.network=new s.default.Network(this.container,{nodes:this.nodes,edges:this.edges},this.config.LEGEND_PANEL_OPTIONS),this.network.on("stabilizationIterationsDone",()=>{this.network.stopSimulation(),this.network.setOptions({physics:{enabled:!1}}),this.statusLogger.setStatusCursor("auto")}),this.network.once("beforeDrawing",()=>{this.positionNodes(),this.network.fit(),this.statusLogger.setStatusText("")})}positionNodes(){for(var e=this.network.DOMtoCanvas({x:48,y:20}),t=-1,o=0;o<this.originalNodes.length;o++){var i=this.originalNodes[o].widthConstraint.minimum;t==this.bigNodeSize&&i==this.smallNodeSize?e.x+=110:t==this.smallNodeSize&&i==this.smallNodeSize&&parseInt(this.originalNodes[o].id,10)<21e4?e.x+=50:t==this.bigNodeSize&&i==this.bigNodeSize?e.x+=165:e.x+=175,this.network.body.nodes[this.originalNodes[o].id].x=e.x,this.network.body.nodes[this.originalNodes[o].id].y=e.y,t=i,console.log(e)}}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(6));t.default=class{constructor(e,t,o,i){this.theoryGraph=e,this.config=t,this.dom=o,this.wrapper=i,this.rectTools={},this.dragTools=!1,this.selectionMode=!1,this.onMessage=this.onMessage.bind(this),s.default(window).bind("message",this.onMessage),this.dom.mainElement$.bind("contextmenu",e=>{e.ctrlKey||e.metaKey?e.stopImmediatePropagation():e.preventDefault()}),this.dom.mainElement$.ready(()=>{this.canvasTools=this.dom.getElementById("toolCanvas"),this.ctxTools=this.canvasTools.getContext("2d"),this.rectTools={},this.containerTools=this.dom.$$("toolCanvas"),this.containerTools.on("mousemove",e=>{1==this.dragTools&&1==this.selectionMode&&(this.rectTools.w=e.offsetX-this.rectTools.startX,this.rectTools.h=e.offsetY-this.rectTools.startY,this.ctxTools.clearRect(0,0,this.canvasTools.width,this.canvasTools.height),this.ctxTools.setLineDash([5]),this.ctxTools.strokeStyle="rgb(0, 102, 0)",this.ctxTools.strokeRect(this.rectTools.startX,this.rectTools.startY,this.rectTools.w,this.rectTools.h),this.ctxTools.setLineDash([]),this.ctxTools.fillStyle="rgba(0, 255, 0, 0.2)",this.ctxTools.fillRect(this.rectTools.startX,this.rectTools.startY,this.rectTools.w,this.rectTools.h),console.log(this.rectTools.startX,this.rectTools.startY,this.rectTools.w,this.rectTools.h))}),this.containerTools.on("mousedown",e=>{1==this.selectionMode&&(this.rectTools={w:0,h:0,startX:e.offsetX,startY:e.offsetY},this.dragTools=!0)}),this.containerTools.on("mouseup",e=>{1==this.dragTools&&(this.dragTools=!1,this.theoryGraph.selectNodesInRect(this.rectTools),this.ctxTools.clearRect(0,0,this.canvasTools.width,this.canvasTools.height),this.switchSelectionMode())})})}destroy(){s.default(window).unbind("message",this.onMessage),this.dom.mainElement$.unbind("contextmenu"),this.containerTools&&(this.containerTools.off("mousemove"),this.containerTools.off("mousedown"),this.containerTools.off("mouseup")),this.canvasTools=void 0,this.ctxTools=void 0,this.rectTools={},this.containerTools=void 0}onMessage(e){this.wrapper.recievedDataJSON=e.originalEvent.data}switchSelectionMode(){0==this.selectionMode?(this.dom.$$("toolCanvas").css("display","block"),this.selectionMode=!0,this.dom.getElementById("toolCanvas").style.cursor="crosshair"):(this.dom.$$("toolCanvas").css("display","none"),this.selectionMode=!1,this.dom.getElementById("toolCanvas").style.cursor="auto")}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(27);const i=o(15);t.default=class{constructor(e,t,o,i,s,n,d){this.dom=e,this.theoryGraph=t,this.tgDomListener=o,this.statusLogger=i,this.options=s,this.actionHistory=n,this.wrapperIn=d,this.handleJson=this.handleJson.bind(this),this.options.THEORY_GRAPH_OPTIONS.manipulation={addNode:this.addNodeCallback.bind(this),editNode:this.editNodeCallback.bind(this),deleteNode:this.deleteNodeCallback.bind(this),addEdge:this.addEdgeCallback.bind(this),editEdge:this.editEdgeCallback.bind(this),deleteEdge:this.deleteEdgeCallback.bind(this)},this.helpDialog=this.dom.$$("helpDialog"),this.helpDialog.dialog({autoOpen:!1}).on("click",()=>{this.helpDialog.dialog("open")}),this.addColors(),this.generateCustomSideMenu();var a=this.options.preferences.viewOnlyMode;void 0!==a&&1==a&&(this.dom.getElementById("menuButtonsDiv").style.display="none"),this.dom.getElementById("jsonLoader").addEventListener("change",this.handleJson,!1),this.addDOMHandler()}destroy(){this.helpDialog.dialog("destroy"),this.dom.getElementById("jsonLoader").removeEventListener("change",this.handleJson)}addDOMHandler(){this.dom.getElementById("leftMenuButton").addEventListener("click",()=>this.openNav(),!1),this.dom.getElementById("rightMenuButton").addEventListener("click",()=>{this.openNav2()},!1),this.dom.getElementById("closeNav2").addEventListener("click",()=>{this.closeNav2()},!1),this.dom.getElementById("closeNav").addEventListener("click",()=>{this.closeNav()},!1),this.dom.getElementById("undoButton").addEventListener("click",()=>{this.actionHistory.undoLastAction()},!1),this.dom.getElementById("redoButton").addEventListener("click",()=>{this.actionHistory.redoLastAction()},!1),this.dom.getElementById("selectionModeButton").addEventListener("click",()=>{this.switchSelectionMode()},!1),this.dom.getElementById("downloadButton").addEventListener("click",()=>{this.downloadGraph()},!1),this.dom.getElementById("clusterButton").addEventListener("click",()=>{this.clusterSelectedNodes()},!1),this.dom.getElementById("cageButton").addEventListener("click",()=>{this.cageSelectedNodes()},!1),this.dom.getElementById("manualHideButton").addEventListener("click",()=>{this.hideSelectedNodes(!0)},!1),this.dom.getElementById("manualShowButton").addEventListener("click",()=>{this.showAllManuallyHiddenNodes()},!1),this.dom.getElementById("helpButton").addEventListener("click",()=>{},!1),this.dom.getElementById("selectNodes").addEventListener("click",()=>{this.selectNodes()},!1),this.dom.getElementById("clusterNodesColor").addEventListener("click",()=>{this.clusterNodesColor()},!1),this.dom.getElementById("iframeRadio").addEventListener("click",()=>{this.generateIFrameGraph()},!1),this.dom.getElementById("htmlRadio").addEventListener("click",()=>{this.generateHTMLGraph()},!1),this.dom.getElementById("parameterRadio").addEventListener("click",()=>{this.generateParameterGraph()},!1),this.dom.getElementById("uriRadio").addEventListener("click",()=>{this.generateURIGraph()},!1),this.dom.getElementById("jsonRadio").addEventListener("click",()=>{this.downloadGraphJSON()},!1),this.dom.getElementById("nodeSpacingBox").addEventListener("change",()=>{this.changeMethod()},!1),this.dom.getElementById("layoutBox").addEventListener("change",e=>{this.changeMethod(e.target.value)},!1)}generateCustomSideMenu(){for(var e="",t=0;t<this.options.GRAPH_TYPES.length;t++)e+='<li data-action="'+this.options.GRAPH_TYPES[t].id+'" title="'+this.options.GRAPH_TYPES[t].tooltip+'">'+this.options.GRAPH_TYPES[t].menuText+"</li>";e+='<li data-action="close" title="Hides this menu">Hide</li>',this.dom.getElementById("side-menu").innerHTML=e}addColors(){for(var e=this.dom.getElementById("colorPicker"),t=this.options.colorizingNodesArray,o=0;o<t.length;o++){var i=document.createElement("div"),s=this.colorizeSelectedNodes.bind(this,t[o]);i.addEventListener("click",s,!1),i.title="Colorize all selected nodes",i.classList.add("colorRect"),i.classList.add("tgview"),i.style.cssText="background-color:"+t[o],e.appendChild(i)}}generateEdgesNodesHideDiv(){var e=this.theoryGraph.getUsedEdgeTypes(),t=this.dom.getElementById("edgesShowHideDiv");t.innerHTML="",(a=document.createElement("strong")).innerHTML="Hide/Show Edges",t.appendChild(a),t.appendChild(document.createElement("br"));for(var o=0;o<e.length;o++){var s=void 0===this.options.ARROW_STYLES[e[o]]?this.options.ARROW_STYLES[e[o].replace("graph","")].alias:this.options.ARROW_STYLES[e[o]].alias,n=document.createElement("img"),d=this.theoryGraph.selectEdgesByType.bind(this.theoryGraph,e[o]);n.addEventListener("click",d,!1),n.src=i.selectPng,n.width=14,n.style.cssText="width:14px",n.title="Select all "+s,t.appendChild(n),(l=document.createElement("input")).type="checkbox",l.id="edgesCheckbox_"+o,l.value=e[o],"meta"!==e[o]&&"graphmeta"!==e[o]&&(l.checked=!0),l.addEventListener("click",e=>{const t=e.target;this.hideEdges(t.value,!t.checked)},!1),t.appendChild(l),(h=document.createElement("label")).setAttribute("for","edgesCheckbox_"+o),h.innerHTML="Show "+s,t.appendChild(h),t.appendChild(document.createElement("br"))}var a,r=this.theoryGraph.getUsedNodeTypes();for(t.appendChild(document.createElement("br")),(a=document.createElement("strong")).innerHTML="Hide/Show Nodes",t.appendChild(a),t.appendChild(document.createElement("br")),o=0;o<r.length;o++){var l,h;s=void 0===this.options.NODE_STYLES[r[o]]?this.options.NODE_STYLES[r[o].replace("graph","")].alias:this.options.NODE_STYLES[r[o]].alias,n=document.createElement("img"),d=this.theoryGraph.selectNodesByType.bind(this.theoryGraph,r[o]),n.addEventListener("click",d,!1),n.src=i.selectPng,n.width=14,n.style.cssText="width:14px",n.title="Select all "+s,t.appendChild(n),(l=document.createElement("input")).type="checkbox",l.id="nodesCheckbox_"+o,l.value=r[o],l.checked=!0,l.addEventListener("click",e=>{const t=e.target;this.hideNodes(t.value,!t.checked)},!1),t.appendChild(l),(h=document.createElement("label")).setAttribute("for","nodesCheckbox_"+o),h.innerHTML="Show "+s,t.appendChild(h),o!=r.length-1&&t.appendChild(document.createElement("br"))}}hideEdges(e,t){this.theoryGraph.hideEdges(e,t)}hideNodes(e,t){this.theoryGraph.hideNodes(e,t)}selectNodes(){this.theoryGraph.selectNodesWithIdLike(prompt("Please enter a name which should be searched for!","node_name"))}downloadGraph(){this.statusLogger.setStatusText("Downloading Image..."),this.theoryGraph.downloadCanvasAsImage(this.dom.getElementById("downloadButton"))}switchSelectionMode(){this.tgDomListener.switchSelectionMode()}clusterSelectedNodes(){this.statusLogger.setStatusText("Clustering Nodes..."),this.theoryGraph.cluster(void 0,prompt("Please choose a name for the cluster","")),this.statusLogger.setStatusText("")}colorizeSelectedNodes(e){this.theoryGraph.colorizeNodes(void 0,e)}changeMethod(e){const t=e?parseInt(e,10):-1;if(this.theoryGraph.manualFocus=!1,this.statusLogger.setStatusText("Relayouting graph..."),this.statusLogger.setStatusCursor("wait"),void 0!==e)if(1==t||2==t||4==t)this.options.THEORY_GRAPH_OPTIONS.layout={ownLayoutIdx:t};else if(0==t)this.options.THEORY_GRAPH_OPTIONS.layout={ownLayoutIdx:0,hierarchical:{sortMethod:"directed",direction:"LR"}};else if(3==t)return this.theoryGraph.manualFocus=!0,void this.statusLogger.setStatusCursor("wait");this.wrapperIn.createNewGraph()}handleJson(e){var t=new FileReader;t.onload=(e=>{const t=e.target.result;console.log(t),this.theoryGraph.doCallAfterConstruction=!0,this.theoryGraph.loadJSONGraph(JSON.parse(t))}),t.readAsText(e.target.files[0])}openNav(){this.dom.getElementById("mySidenav").style.width="400px"}closeNav(){this.dom.getElementById("mySidenav").style.width="0"}openNav2(){this.dom.getElementById("mySidenav2").style.width="400px"}closeNav2(){this.dom.getElementById("mySidenav2").style.width="0"}cageSelectedNodes(){console.log("cageSelectedNodes"),this.theoryGraph.cageNodes(void 0,void 0)}hideSelectedNodes(e){this.theoryGraph.hideNodesById(void 0,e)}showAllManuallyHiddenNodes(){this.theoryGraph.showAllManuallyHiddenNodes()}clusterNodesColor(){this.theoryGraph.clusterUsingColor()}downloadGraphJSON(){this.download("graph_data.json",this.theoryGraph.graphToStringJSON(void 0,void 0))}download(e,t){var o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}generateIFrameGraph(){var e=this.theoryGraph.graphToIFrameString(void 0,void 0,void 0),t="<script>";t+="function sendMessageToIFrameFromLocalStorage"+e.id+"(param){ var tmp=localStorage.getItem(param); document.getElementById(options.external.prefix+'"+e.id+"').contentWindow.postMessage(tmp, '*'); }\r\n"+e.storage,t+="<\/script>\r\n",t+="<iframe style='width:100%;min-height:550px;' src='"+e.uri+"' onLoad=\"sendMessageToIFrameFromLocalStorage"+e.id+"('"+e.id+"')\" id='"+e.id+"'></iframe>",this.dom.getElementById("uriTextarea").value="",this.dom.getElementById("informationTextarea").value=t}generateHTMLGraph(){var e=this.theoryGraph.graphToLocalStorageString(void 0,void 0,void 0);this.dom.getElementById("uriTextarea").value=e.uri,this.dom.getElementById("informationTextarea").value=e.storage}generateParameterGraph(){var e=this.theoryGraph.graphToURIParameterString(void 0,void 0);e.length>220?(this.dom.getElementById("uriTextarea").value="",this.dom.getElementById("informationTextarea").value="",alert("Graph is too big to be embedded in URI. Select HTML-Embedding or IFrame-Embedding instead!")):(this.dom.getElementById("uriTextarea").value=e,this.dom.getElementById("informationTextarea").value="")}generateURIGraph(){this.dom.getElementById("uriTextarea").value=window.location.href,this.dom.getElementById("informationTextarea").value=""}addDataNode(e){e.id=this.dom.getElementById("node-id").value,0!=this.theoryGraph.isUniqueId(e.id)?(e.label=this.dom.getElementById("node-label").value,e.url=this.dom.getElementById("node-url").value,e.mathml=this.dom.getElementById("node-mathml").value,e.style=this.dom.getElementById("node-style").value,this.clearPopUp(),this.theoryGraph.addNode(e)):alert("The ID entered is already used, please enter an unique ID.")}addDataEdge(e){var t={};t.id=this.dom.getElementById("edge-id").value,0!=this.theoryGraph.isUniqueEdgeId(t.id)?(t.label=this.dom.getElementById("edge-label").value,t.url=this.dom.getElementById("edge-url").value,t.style=this.dom.getElementById("edge-style").value,t.from=e.from,t.to=e.to,this.clearPopUp(),this.theoryGraph.addEdge(t)):alert("The ID entered is already used, please enter an unique ID.")}editDataEdge(e,t){var o={};o.id=this.dom.getElementById("edge-id").value,o.label=this.dom.getElementById("edge-label").value,o.url=this.dom.getElementById("edge-url").value,o.style=this.dom.getElementById("edge-style").value,o.from=e.from,o.to=e.to,this.clearPopUp(),this.theoryGraph.saveEdge(o),t(null)}saveDataNode(e,t){var o={};o.id=this.dom.getElementById("node-id").value,o.label=this.dom.getElementById("node-label").value,o.url=this.dom.getElementById("node-url").value,o.mathml=this.dom.getElementById("node-mathml").value,o.style=this.dom.getElementById("node-style").value,this.clearPopUp(),this.theoryGraph.saveNode(o),t(null)}clearPopUp(){this.dom.getElementById("saveButton").onclick=null,this.dom.getElementById("cancelButton").onclick=null,this.dom.getElementById("network-popUp").style.display="none",this.dom.getElementById("edge-saveButton").onclick=null,this.dom.getElementById("edge-cancelButton").onclick=null,this.dom.getElementById("network-edge-popUp").style.display="none"}cancelEdit(e){this.clearPopUp(),e(null)}addNodeCallback(e,t){this.dom.getElementById("operation").innerHTML="Add Node",this.dom.getElementById("node-id").value=e.id,this.dom.getElementById("node-label").value=e.label,this.dom.getElementById("node-url").value="",this.dom.getElementById("node-mathml").value="";var o="";Object.keys(this.options.NODE_STYLES).forEach(e=>{o+='<option value="'+e+'">'+this.options.NODE_STYLES[e].alias+"</option>"}),this.dom.getElementById("node-style").innerHTML=o,this.dom.getElementById("saveButton").onclick=this.addDataNode.bind(this,e,t),this.dom.getElementById("cancelButton").onclick=this.clearPopUp.bind(this),this.dom.getElementById("network-popUp").style.display="block"}editNodeCallback(e,t){this.dom.getElementById("operation").innerHTML="Edit Node",this.dom.getElementById("node-id").value=e.id,this.dom.getElementById("node-id").disabled=!0,this.dom.getElementById("node-label").value=void 0!==e.label?e.label:"",this.dom.getElementById("node-url").value=void 0!==e.url?e.url:"",this.dom.getElementById("node-mathml").value=void 0!==e.mathml?e.mathml:"";var o="";Object.keys(this.options.NODE_STYLES).forEach(e=>{o+='<option value="'+e+'">'+this.options.NODE_STYLES[e].alias+"</option>"}),this.dom.getElementById("node-style").innerHTML=o,void 0!==e.style&&(this.dom.getElementById("node-style").value=e.style),this.dom.getElementById("saveButton").onclick=this.saveDataNode.bind(this,e,t),this.dom.getElementById("cancelButton").onclick=this.cancelEdit.bind(this,t),this.dom.getElementById("network-popUp").style.display="block"}addEdgeCallbackHelper(e,t){this.dom.getElementById("edge-operation").innerHTML="Add Edge",this.dom.getElementById("edge-id").value="edge_"+Math.random().toString(36).substr(2,9),this.dom.getElementById("edge-label").value="",this.dom.getElementById("edge-url").value="";var o="";Object.keys(this.options.ARROW_STYLES).forEach(e=>{o+='<option value="'+e+'">'+this.options.ARROW_STYLES[e].alias+"</option>"}),this.dom.getElementById("edge-style").innerHTML=o,this.dom.getElementById("edge-saveButton").onclick=this.addDataEdge.bind(this,e,t),this.dom.getElementById("edge-cancelButton").onclick=this.clearPopUp.bind(this),this.dom.getElementById("network-edge-popUp").style.display="block"}addEdgeCallback(e,t){e.from==e.to?1==confirm("Do you want to connect the node to itself?")&&this.addEdgeCallbackHelper(e,t):this.addEdgeCallbackHelper(e,t)}deleteEdgeCallback(e,t){console.log(e),this.theoryGraph.deleteEdges(e.edges)}deleteNodeCallback(e,t){console.log(e),this.theoryGraph.deleteNodes(e.nodes,e.edges)}editEdgeCallbackHelper(e,t){this.dom.getElementById("edge-operation").innerHTML="Edit Edge",this.dom.getElementById("edge-id").value=e.id,this.dom.getElementById("edge-label").value=void 0!==e.label?e.label:"",this.dom.getElementById("edge-url").value=void 0!==e.url?e.url:"";var o="";Object.keys(this.options.ARROW_STYLES).forEach(e=>{o+='<option value="'+e+'">'+this.options.ARROW_STYLES[e].alias+"</option>"}),this.dom.getElementById("edge-style").innerHTML=o,this.dom.getElementById("edge-saveButton").onclick=this.editDataEdge.bind(this,e,t),this.dom.getElementById("edge-cancelButton").onclick=this.clearPopUp.bind(this),this.dom.getElementById("network-edge-popUp").style.display="block"}editEdgeCallback(e,t){e.from==e.to?1==confirm("Do you want to connect the node to itself?")&&this.editEdgeCallbackHelper(e,t):this.editEdgeCallbackHelper(e,t)}}},,function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(o(6));o(29);t.default=class{constructor(e,t,o){this.config=e,this.wrapper=o,this.tracker=new n(t.mainElement),this.treeElement=t.$$("theory_tree"),this.contextMenuElement=t.$$("side-menu"),this.treeElement.jstree({core:{check_callback:!0,themes:{stripes:!1,icons:!1}},types:{default:{valid_children:["default","file"]}},plugins:["dnd","search","state","types","wholerow"]}),this.treeElement.on("select_node.jstree",(e,t)=>{e.ctrlKey||e.metaKey?e.stopImmediatePropagation():(e.preventDefault(),this.wrapper.lastGraphDataUsed=t.node.original.graphdata,this.contextMenuElement.finish().show(10).css({top:this.tracker.mouseY()-8,left:this.tracker.mouseX()+4}))}),this.treeElement.on("open_node.jstree",(e,t)=>{this.contextMenuElement.hide(10),t.node.children=[];const o=this.config.menuEntriesURL(t.node.original.serverId);s.default.get(o,e=>this.addTreeNodes(e,t.node.id))}),s.default.get(this.config.menuEntriesURL(),e=>this.addTreeNodes(e))}destroy(){this.tracker.destroy(),this.treeElement.off("select_node.jstree").off("open_node.jstree").jstree(!0).destroy()}addTreeNodes(e,t="#"){const o=this.treeElement.jstree();e.forEach(e=>{const i=e.id+Math.floor(5e3*Math.random()),s=e.hasChildren?[{id:"placeholder"}]:void 0,n={id:i,text:e.menuText,serverId:e.id,graphdata:e.uri,typeGraph:e.type,children:s,state:{opened:!e.hasChildren}};o.create_node(t,n,"last",function(){})})}};class n{constructor(e){this.element=e,this.pageX=0,this.pageY=0,this.handleMouseMove=(e=>{e=e||window.event,this.pageX=e.pageX,this.pageY=e.pageY}),this.element.onmousemove=this.handleMouseMove}destroy(){this.element.onmousemove=null}mouseX(){return this.pageX}mouseY(){return this.pageY}}}]]);